/home/aakli/miniconda3/envs/adapter/lib/python3.10/site-packages/transformers/utils/generic.py:260: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  torch.utils._pytree._register_pytree_node(
INFO:name:device: cuda:2, n_gpu: 1
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /Salesforce/codet5p-220m/resolve/main/config.json HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /Salesforce/codet5p-220m/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
[INFO|(OpenDelta)basemodel:700]2025-01-09 00:57:32,397 >> Trainable Ratio: 2177024/225059072=0.967312%
[INFO|(OpenDelta)basemodel:702]2025-01-09 00:57:32,397 >> Delta Parameter Ratio: 2177024/225059072=0.967312%
[INFO|(OpenDelta)basemodel:704]2025-01-09 00:57:32,397 >> Static Memory 0.00 GB, Max Memory 0.00 GB
INFO:name:1.95
INFO:name:***** Running training for defect detection *****
INFO:name:  Num examples = 21854
INFO:name:  Num Epochs = 15
INFO:name:  Total train batch size  = 32
INFO:name:  Total optimization steps = 10245

 [{'insert_modules': ('layer.0.SelfAttention',), 'bottleneck_dim': (16,), 'non_linearity': 'silu', 'dropout_rate': 0.1, 'normalization': None, 'skip_connection': True}, 0, {'insert_modules': ('layer.1.DenseReluDense',), 'bottleneck_dim': (128,), 'non_linearity': 'gelu_new', 'dropout_rate': 0.25, 'normalization': 'layer_norm', 'skip_connection': True}, {'insert_modules': ('layer.0',), 'bottleneck_dim': (64,), 'non_linearity': 'swish', 'dropout_rate': 0.1, 'normalization': None, 'skip_connection': True}, {'insert_modules': ('layer.1.DenseReluDense',), 'bottleneck_dim': (128,), 'non_linearity': 'silu', 'dropout_rate': 0.3, 'normalization': None, 'skip_connection': True}, {'insert_modules': ('layer.1', 'layer.0', 'layer.1.DenseReluDense'), 'bottleneck_dim': (128, 64, 128), 'non_linearity': 'swish', 'dropout_rate': 0.1, 'normalization': None, 'skip_connection': True}, {'insert_modules': ('layer.0', 'layer.1.DenseReluDense'), 'bottleneck_dim': (128, 64), 'non_linearity': 'relu', 'dropout_rate': 0.25, 'normalization': 'layer_norm', 'skip_connection': True}, 0, {'insert_modules': ('layer.1.DenseReluDense', 'layer.0.SelfAttention', 'layer.0'), 'bottleneck_dim': (128, 32, 64), 'non_linearity': 'leakyrelu', 'dropout_rate': 0.1, 'normalization': None, 'skip_connection': True}, 0, {'insert_modules': ('layer.1', 'layer.0.SelfAttention'), 'bottleneck_dim': (128, 16), 'non_linearity': 'tanh', 'dropout_rate': 0.25, 'normalization': None, 'skip_connection': True}, {'insert_modules': ('layer.1.DenseReluDense', 'layer.1'), 'bottleneck_dim': (64, 128), 'non_linearity': 'gelu', 'dropout_rate': 0.0, 'normalization': None, 'skip_connection': True}] 

INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 0 Step 99 Train Loss 0.694   Accuracy 49.781 
Epoch 0 Step 199 Train Loss 0.691   Accuracy 52.125 
Epoch 0 Step 299 Train Loss 0.69   Accuracy 53.135 
Epoch 0 Step 399 Train Loss 0.69   Accuracy 53.391 
Epoch 0 Step 499 Train Loss 0.69   Accuracy 53.456 
Epoch 0 Step 599 Train Loss 0.689   Accuracy 53.927 
INFO:name:  eval_loss = 0.6905
INFO:name:  eval_acc = 0.5476
INFO:name:  f1_score = 0.2993
INFO:name:  recall = 0.2224
INFO:name:  precision = 0.4575
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.5476
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.5556, 'test_f1_score': 0.3373, 'test_recall': 0.2462, 'test_precision': 0.5355}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 1 Step 99 Train Loss 0.687   Accuracy 55.5 
Epoch 1 Step 199 Train Loss 0.686   Accuracy 55.281 
Epoch 1 Step 299 Train Loss 0.688   Accuracy 55.094 
Epoch 1 Step 399 Train Loss 0.687   Accuracy 55.586 
Epoch 1 Step 499 Train Loss 0.687   Accuracy 55.506 
Epoch 1 Step 599 Train Loss 0.686   Accuracy 55.318 
INFO:name:  eval_loss = 0.6849
INFO:name:  eval_acc = 0.5454
INFO:name:  f1_score = 0.4029
INFO:name:  recall = 0.353
INFO:name:  precision = 0.4692
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 2 Step 99 Train Loss 0.679   Accuracy 56.188 
Epoch 2 Step 199 Train Loss 0.677   Accuracy 56.828 
Epoch 2 Step 299 Train Loss 0.676   Accuracy 57.479 
Epoch 2 Step 399 Train Loss 0.675   Accuracy 57.672 
Epoch 2 Step 499 Train Loss 0.675   Accuracy 57.781 
Epoch 2 Step 599 Train Loss 0.673   Accuracy 57.885 
INFO:name:  eval_loss = 0.6468
INFO:name:  eval_acc = 0.6098
INFO:name:  f1_score = 0.3729
INFO:name:  recall = 0.2671
INFO:name:  precision = 0.6179
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6098
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.5974, 'test_f1_score': 0.3785, 'test_recall': 0.2669, 'test_precision': 0.6505}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 3 Step 99 Train Loss 0.65   Accuracy 60.156 
Epoch 3 Step 199 Train Loss 0.647   Accuracy 60.953 
Epoch 3 Step 299 Train Loss 0.642   Accuracy 61.635 
Epoch 3 Step 399 Train Loss 0.645   Accuracy 61.094 
Epoch 3 Step 499 Train Loss 0.645   Accuracy 61.069 
Epoch 3 Step 599 Train Loss 0.644   Accuracy 61.068 
INFO:name:  eval_loss = 0.6573
INFO:name:  eval_acc = 0.6058
INFO:name:  f1_score = 0.5881
INFO:name:  recall = 0.6479
INFO:name:  precision = 0.5385
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 4 Step 99 Train Loss 0.625   Accuracy 63.25 
Epoch 4 Step 199 Train Loss 0.614   Accuracy 64.078 
Epoch 4 Step 299 Train Loss 0.617   Accuracy 63.781 
Epoch 4 Step 399 Train Loss 0.619   Accuracy 63.547 
Epoch 4 Step 499 Train Loss 0.62   Accuracy 63.55 
Epoch 4 Step 599 Train Loss 0.621   Accuracy 63.396 
INFO:name:  eval_loss = 0.6218
INFO:name:  eval_acc = 0.6351
INFO:name:  f1_score = 0.5965
INFO:name:  recall = 0.6209
INFO:name:  precision = 0.574
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6351
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6277, 'test_f1_score': 0.5959, 'test_recall': 0.5976, 'test_precision': 0.5943}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 5 Step 99 Train Loss 0.608   Accuracy 64.531 
Epoch 5 Step 199 Train Loss 0.605   Accuracy 64.484 
Epoch 5 Step 299 Train Loss 0.604   Accuracy 64.573 
Epoch 5 Step 399 Train Loss 0.604   Accuracy 65.078 
Epoch 5 Step 499 Train Loss 0.602   Accuracy 65.262 
Epoch 5 Step 599 Train Loss 0.602   Accuracy 65.26 
INFO:name:  eval_loss = 0.6189
INFO:name:  eval_acc = 0.6296
INFO:name:  f1_score = 0.5903
INFO:name:  recall = 0.6142
INFO:name:  precision = 0.5682
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 6 Step 99 Train Loss 0.583   Accuracy 67.156 
Epoch 6 Step 199 Train Loss 0.591   Accuracy 66.406 
Epoch 6 Step 299 Train Loss 0.59   Accuracy 65.979 
Epoch 6 Step 399 Train Loss 0.585   Accuracy 66.586 
Epoch 6 Step 499 Train Loss 0.584   Accuracy 66.775 
Epoch 6 Step 599 Train Loss 0.585   Accuracy 66.885 
INFO:name:  eval_loss = 0.6274
INFO:name:  eval_acc = 0.6376
INFO:name:  f1_score = 0.5943
INFO:name:  recall = 0.6108
INFO:name:  precision = 0.5786
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6376
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6266, 'test_f1_score': 0.5959, 'test_recall': 0.5992, 'test_precision': 0.5926}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 7 Step 99 Train Loss 0.569   Accuracy 67.5 
Epoch 7 Step 199 Train Loss 0.572   Accuracy 67.266 
Epoch 7 Step 299 Train Loss 0.571   Accuracy 67.521 
Epoch 7 Step 399 Train Loss 0.569   Accuracy 67.648 
Epoch 7 Step 499 Train Loss 0.567   Accuracy 67.988 
Epoch 7 Step 599 Train Loss 0.568   Accuracy 68.052 
INFO:name:  eval_loss = 0.6242
INFO:name:  eval_acc = 0.6362
INFO:name:  f1_score = 0.5879
INFO:name:  recall = 0.5973
INFO:name:  precision = 0.5788
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 8 Step 99 Train Loss 0.537   Accuracy 70.312 
Epoch 8 Step 199 Train Loss 0.542   Accuracy 70.516 
Epoch 8 Step 299 Train Loss 0.546   Accuracy 70.01 
Epoch 8 Step 399 Train Loss 0.548   Accuracy 69.805 
Epoch 8 Step 499 Train Loss 0.549   Accuracy 69.756 
Epoch 8 Step 599 Train Loss 0.547   Accuracy 69.771 
INFO:name:  eval_loss = 0.6277
INFO:name:  eval_acc = 0.6296
INFO:name:  f1_score = 0.6224
INFO:name:  recall = 0.7026
INFO:name:  precision = 0.5586
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 9 Step 99 Train Loss 0.542   Accuracy 70.406 
Epoch 9 Step 199 Train Loss 0.534   Accuracy 70.641 
Epoch 9 Step 299 Train Loss 0.529   Accuracy 71.292 
Epoch 9 Step 399 Train Loss 0.527   Accuracy 71.516 
Epoch 9 Step 499 Train Loss 0.529   Accuracy 71.356 
Epoch 9 Step 599 Train Loss 0.529   Accuracy 71.24 
INFO:name:  eval_loss = 0.6522
INFO:name:  eval_acc = 0.6435
INFO:name:  f1_score = 0.5841
INFO:name:  recall = 0.5762
INFO:name:  precision = 0.5922
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6435
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6395, 'test_f1_score': 0.5955, 'test_recall': 0.5777, 'test_precision': 0.6144}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 10 Step 99 Train Loss 0.528   Accuracy 71.031 
Epoch 10 Step 199 Train Loss 0.524   Accuracy 71.781 
Epoch 10 Step 299 Train Loss 0.517   Accuracy 72.146 
Epoch 10 Step 399 Train Loss 0.519   Accuracy 71.812 
Epoch 10 Step 499 Train Loss 0.519   Accuracy 71.919 
Epoch 10 Step 599 Train Loss 0.519   Accuracy 71.766 
INFO:name:  eval_loss = 0.6668
INFO:name:  eval_acc = 0.6336
INFO:name:  f1_score = 0.5985
INFO:name:  recall = 0.6285
INFO:name:  precision = 0.5712
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 11 Step 99 Train Loss 0.499   Accuracy 73.125 
Epoch 11 Step 199 Train Loss 0.505   Accuracy 72.656 
Epoch 11 Step 299 Train Loss 0.505   Accuracy 72.99 
Epoch 11 Step 399 Train Loss 0.506   Accuracy 73.125 
Epoch 11 Step 499 Train Loss 0.505   Accuracy 72.981 
Epoch 11 Step 599 Train Loss 0.505   Accuracy 73.083 
INFO:name:  eval_loss = 0.6629
INFO:name:  eval_acc = 0.6409
INFO:name:  f1_score = 0.6211
INFO:name:  recall = 0.6773
INFO:name:  precision = 0.5735
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 12 Step 99 Train Loss 0.489   Accuracy 74.031 
Epoch 12 Step 199 Train Loss 0.485   Accuracy 74.344 
Epoch 12 Step 299 Train Loss 0.487   Accuracy 74.094 
Epoch 12 Step 399 Train Loss 0.487   Accuracy 73.961 
Epoch 12 Step 499 Train Loss 0.488   Accuracy 74.081 
Epoch 12 Step 599 Train Loss 0.488   Accuracy 74.146 
INFO:name:  eval_loss = 0.6963
INFO:name:  eval_acc = 0.6446
INFO:name:  f1_score = 0.5717
INFO:name:  recall = 0.5459
INFO:name:  precision = 0.6
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6446
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6299, 'test_f1_score': 0.575, 'test_recall': 0.545, 'test_precision': 0.6085}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 13 Step 99 Train Loss 0.483   Accuracy 73.938 
Epoch 13 Step 199 Train Loss 0.48   Accuracy 74.062 
Epoch 13 Step 299 Train Loss 0.48   Accuracy 74.51 
Epoch 13 Step 399 Train Loss 0.477   Accuracy 74.703 
Epoch 13 Step 499 Train Loss 0.476   Accuracy 74.781 
Epoch 13 Step 599 Train Loss 0.477   Accuracy 74.88 
INFO:name:  eval_loss = 0.7124
INFO:name:  eval_acc = 0.6468
INFO:name:  f1_score = 0.5954
INFO:name:  recall = 0.5981
INFO:name:  precision = 0.5927
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6468
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6299, 'test_f1_score': 0.5932, 'test_recall': 0.5873, 'test_precision': 0.5992}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 14 Step 99 Train Loss 0.465   Accuracy 75.969 
Epoch 14 Step 199 Train Loss 0.458   Accuracy 76.453 
Epoch 14 Step 299 Train Loss 0.458   Accuracy 76.594 
Epoch 14 Step 399 Train Loss 0.459   Accuracy 76.305 
Epoch 14 Step 499 Train Loss 0.462   Accuracy 76.075 
Epoch 14 Step 599 Train Loss 0.463   Accuracy 76.021 
INFO:name:  eval_loss = 0.7311
INFO:name:  eval_acc = 0.6428
INFO:name:  f1_score = 0.5977
INFO:name:  recall = 0.6108
INFO:name:  precision = 0.5851
INFO:name:Saving model checkpoint to ./models/final_model_defect/model.bin
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6314, 'test_f1_score': 0.6028, 'test_recall': 0.6088, 'test_precision': 0.5969}
[INFO|(OpenDelta)basemodel:700]2025-01-09 02:14:35,744 >> Trainable Ratio: 2177024/225059072=0.967312%
[INFO|(OpenDelta)basemodel:702]2025-01-09 02:14:35,745 >> Delta Parameter Ratio: 2177024/225059072=0.967312%
[INFO|(OpenDelta)basemodel:704]2025-01-09 02:14:35,745 >> Static Memory 0.02 GB, Max Memory 17.11 GB
INFO:name:1.95
INFO:name:***** Running training for defect detection *****
INFO:name:  Num examples = 21854
INFO:name:  Num Epochs = 15
INFO:name:  Total train batch size  = 32
INFO:name:  Total optimization steps = 10245
train results {'train_loss': [0.689, 0.686, 0.671, 0.644, 0.621, 0.602, 0.585, 0.567, 0.548, 0.53, 0.518, 0.506, 0.489, 0.476, 0.463], 'train_acc': [53.989, 55.35, 58.209, 61.147, 63.287, 65.251, 66.715, 68.111, 69.859, 71.173, 71.767, 73.044, 74.143, 74.893, 75.898], 'eval_loss': [0.691, 0.685, 0.647, 0.657, 0.622, 0.619, 0.627, 0.624, 0.628, 0.652, 0.667, 0.663, 0.696, 0.712, 0.731], 'eval_acc': [0.548, 0.545, 0.61, 0.606, 0.635, 0.63, 0.638, 0.636, 0.63, 0.644, 0.634, 0.641, 0.645, 0.647, 0.643], 'eval_f1': [0.299, 0.403, 0.373, 0.588, 0.596, 0.59, 0.594, 0.588, 0.622, 0.584, 0.598, 0.621, 0.572, 0.595, 0.598], 'eval_precision': [0.458, 0.469, 0.618, 0.538, 0.574, 0.568, 0.579, 0.579, 0.559, 0.592, 0.571, 0.574, 0.6, 0.593, 0.585], 'eval_recall': [0.222, 0.353, 0.267, 0.648, 0.621, 0.614, 0.611, 0.597, 0.703, 0.576, 0.628, 0.677, 0.546, 0.598, 0.611]}

 [{'insert_modules': ('layer.0.SelfAttention',), 'bottleneck_dim': (16,), 'non_linearity': 'silu', 'dropout_rate': 0.1, 'normalization': None, 'skip_connection': True}, 0, {'insert_modules': ('layer.1.DenseReluDense',), 'bottleneck_dim': (128,), 'non_linearity': 'gelu_new', 'dropout_rate': 0.25, 'normalization': 'layer_norm', 'skip_connection': True}, {'insert_modules': ('layer.0',), 'bottleneck_dim': (64,), 'non_linearity': 'swish', 'dropout_rate': 0.1, 'normalization': None, 'skip_connection': True}, {'insert_modules': ('layer.1.DenseReluDense',), 'bottleneck_dim': (128,), 'non_linearity': 'silu', 'dropout_rate': 0.3, 'normalization': None, 'skip_connection': True}, {'insert_modules': ('layer.1', 'layer.0', 'layer.1.DenseReluDense'), 'bottleneck_dim': (128, 64, 128), 'non_linearity': 'swish', 'dropout_rate': 0.1, 'normalization': None, 'skip_connection': True}, {'insert_modules': ('layer.0', 'layer.1.DenseReluDense'), 'bottleneck_dim': (128, 64), 'non_linearity': 'relu', 'dropout_rate': 0.25, 'normalization': 'layer_norm', 'skip_connection': True}, 0, {'insert_modules': ('layer.1.DenseReluDense', 'layer.0.SelfAttention', 'layer.0'), 'bottleneck_dim': (128, 32, 64), 'non_linearity': 'leakyrelu', 'dropout_rate': 0.1, 'normalization': None, 'skip_connection': True}, {'insert_modules': ('layer.1', 'layer.0.SelfAttention'), 'bottleneck_dim': (128, 16), 'non_linearity': 'tanh', 'dropout_rate': 0.25, 'normalization': None, 'skip_connection': True}, 0, {'insert_modules': ('layer.1.DenseReluDense', 'layer.1'), 'bottleneck_dim': (64, 128), 'non_linearity': 'gelu', 'dropout_rate': 0.0, 'normalization': None, 'skip_connection': True}] 

INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 0 Step 99 Train Loss 0.694   Accuracy 49.625 
Epoch 0 Step 199 Train Loss 0.691   Accuracy 51.891 
Epoch 0 Step 299 Train Loss 0.69   Accuracy 53.052 
Epoch 0 Step 399 Train Loss 0.69   Accuracy 53.352 
Epoch 0 Step 499 Train Loss 0.69   Accuracy 53.344 
Epoch 0 Step 599 Train Loss 0.689   Accuracy 53.875 
INFO:name:  eval_loss = 0.6882
INFO:name:  eval_acc = 0.5483
INFO:name:  f1_score = 0.2681
INFO:name:  recall = 0.1904
INFO:name:  precision = 0.4529
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.5483
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.5582, 'test_f1_score': 0.3123, 'test_recall': 0.2183, 'test_precision': 0.548}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 1 Step 99 Train Loss 0.687   Accuracy 54.625 
Epoch 1 Step 199 Train Loss 0.687   Accuracy 55.047 
Epoch 1 Step 299 Train Loss 0.688   Accuracy 54.812 
Epoch 1 Step 399 Train Loss 0.687   Accuracy 55.344 
Epoch 1 Step 499 Train Loss 0.687   Accuracy 55.362 
Epoch 1 Step 599 Train Loss 0.686   Accuracy 55.281 
INFO:name:  eval_loss = 0.6822
INFO:name:  eval_acc = 0.5545
INFO:name:  f1_score = 0.3978
INFO:name:  recall = 0.3387
INFO:name:  precision = 0.482
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.5545
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.56, 'test_f1_score': 0.4221, 'test_recall': 0.3498, 'test_precision': 0.5321}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 2 Step 99 Train Loss 0.677   Accuracy 57.062 
Epoch 2 Step 199 Train Loss 0.677   Accuracy 56.938 
Epoch 2 Step 299 Train Loss 0.675   Accuracy 57.135 
Epoch 2 Step 399 Train Loss 0.676   Accuracy 57.125 
Epoch 2 Step 499 Train Loss 0.674   Accuracy 57.45 
Epoch 2 Step 599 Train Loss 0.672   Accuracy 57.745 
INFO:name:  eval_loss = 0.6477
INFO:name:  eval_acc = 0.608
INFO:name:  f1_score = 0.4572
INFO:name:  recall = 0.3799
INFO:name:  precision = 0.5738
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.608
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.5996, 'test_f1_score': 0.459, 'test_recall': 0.3697, 'test_precision': 0.605}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 3 Step 99 Train Loss 0.648   Accuracy 61.375 
Epoch 3 Step 199 Train Loss 0.649   Accuracy 61.438 
Epoch 3 Step 299 Train Loss 0.648   Accuracy 61.438 
Epoch 3 Step 399 Train Loss 0.649   Accuracy 61.32 
Epoch 3 Step 499 Train Loss 0.647   Accuracy 61.344 
Epoch 3 Step 599 Train Loss 0.645   Accuracy 61.406 
INFO:name:  eval_loss = 0.6278
INFO:name:  eval_acc = 0.6065
INFO:name:  f1_score = 0.532
INFO:name:  recall = 0.5147
INFO:name:  precision = 0.5505
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 4 Step 99 Train Loss 0.618   Accuracy 63.688 
Epoch 4 Step 199 Train Loss 0.623   Accuracy 63.312 
Epoch 4 Step 299 Train Loss 0.622   Accuracy 63.604 
Epoch 4 Step 399 Train Loss 0.624   Accuracy 63.648 
Epoch 4 Step 499 Train Loss 0.624   Accuracy 63.65 
Epoch 4 Step 599 Train Loss 0.623   Accuracy 63.688 
INFO:name:  eval_loss = 0.6341
INFO:name:  eval_acc = 0.5992
INFO:name:  f1_score = 0.5982
INFO:name:  recall = 0.6866
INFO:name:  precision = 0.5299
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 5 Step 99 Train Loss 0.619   Accuracy 63.656 
Epoch 5 Step 199 Train Loss 0.611   Accuracy 64.312 
Epoch 5 Step 299 Train Loss 0.607   Accuracy 64.729 
Epoch 5 Step 399 Train Loss 0.609   Accuracy 64.602 
Epoch 5 Step 499 Train Loss 0.608   Accuracy 64.894 
Epoch 5 Step 599 Train Loss 0.607   Accuracy 64.859 
INFO:name:  eval_loss = 0.6219
INFO:name:  eval_acc = 0.6061
INFO:name:  f1_score = 0.6101
INFO:name:  recall = 0.7094
INFO:name:  precision = 0.5353
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 6 Step 99 Train Loss 0.59   Accuracy 67.438 
Epoch 6 Step 199 Train Loss 0.595   Accuracy 66.672 
Epoch 6 Step 299 Train Loss 0.593   Accuracy 66.531 
Epoch 6 Step 399 Train Loss 0.589   Accuracy 66.773 
Epoch 6 Step 499 Train Loss 0.588   Accuracy 66.812 
Epoch 6 Step 599 Train Loss 0.588   Accuracy 66.807 
INFO:name:  eval_loss = 0.6168
INFO:name:  eval_acc = 0.6296
INFO:name:  f1_score = 0.5679
INFO:name:  recall = 0.5602
INFO:name:  precision = 0.5758
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6296
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6241, 'test_f1_score': 0.5779, 'test_recall': 0.5602, 'test_precision': 0.5968}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 7 Step 99 Train Loss 0.569   Accuracy 68.156 
Epoch 7 Step 199 Train Loss 0.571   Accuracy 68.047 
Epoch 7 Step 299 Train Loss 0.571   Accuracy 68.021 
Epoch 7 Step 399 Train Loss 0.57   Accuracy 67.984 
Epoch 7 Step 499 Train Loss 0.571   Accuracy 67.919 
Epoch 7 Step 599 Train Loss 0.572   Accuracy 67.948 
INFO:name:  eval_loss = 0.6334
INFO:name:  eval_acc = 0.6234
INFO:name:  f1_score = 0.6113
INFO:name:  recall = 0.6816
INFO:name:  precision = 0.5541
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 8 Step 99 Train Loss 0.549   Accuracy 69.188 
Epoch 8 Step 199 Train Loss 0.555   Accuracy 69.625 
Epoch 8 Step 299 Train Loss 0.555   Accuracy 69.615 
Epoch 8 Step 399 Train Loss 0.556   Accuracy 69.688 
Epoch 8 Step 499 Train Loss 0.556   Accuracy 69.375 
Epoch 8 Step 599 Train Loss 0.555   Accuracy 69.438 
INFO:name:  eval_loss = 0.6615
INFO:name:  eval_acc = 0.6149
INFO:name:  f1_score = 0.6254
INFO:name:  recall = 0.7397
INFO:name:  precision = 0.5416
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 9 Step 99 Train Loss 0.552   Accuracy 70.156 
Epoch 9 Step 199 Train Loss 0.545   Accuracy 70.141 
Epoch 9 Step 299 Train Loss 0.542   Accuracy 70.094 
Epoch 9 Step 399 Train Loss 0.541   Accuracy 70.219 
Epoch 9 Step 499 Train Loss 0.541   Accuracy 70.475 
Epoch 9 Step 599 Train Loss 0.541   Accuracy 70.547 
INFO:name:  eval_loss = 0.6241
INFO:name:  eval_acc = 0.6373
INFO:name:  f1_score = 0.5834
INFO:name:  recall = 0.5847
INFO:name:  precision = 0.5822
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6373
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6307, 'test_f1_score': 0.5923, 'test_recall': 0.5841, 'test_precision': 0.6008}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 10 Step 99 Train Loss 0.525   Accuracy 71.125 
Epoch 10 Step 199 Train Loss 0.526   Accuracy 71.609 
Epoch 10 Step 299 Train Loss 0.524   Accuracy 71.646 
Epoch 10 Step 399 Train Loss 0.525   Accuracy 71.641 
Epoch 10 Step 499 Train Loss 0.525   Accuracy 71.706 
Epoch 10 Step 599 Train Loss 0.524   Accuracy 71.76 
INFO:name:  eval_loss = 0.6564
INFO:name:  eval_acc = 0.6351
INFO:name:  f1_score = 0.6287
INFO:name:  recall = 0.711
INFO:name:  precision = 0.5634
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 11 Step 99 Train Loss 0.504   Accuracy 74.094 
Epoch 11 Step 199 Train Loss 0.512   Accuracy 73.188 
Epoch 11 Step 299 Train Loss 0.513   Accuracy 73.125 
Epoch 11 Step 399 Train Loss 0.511   Accuracy 73.406 
Epoch 11 Step 499 Train Loss 0.511   Accuracy 73.306 
Epoch 11 Step 599 Train Loss 0.507   Accuracy 73.443 
INFO:name:  eval_loss = 0.693
INFO:name:  eval_acc = 0.6175
INFO:name:  f1_score = 0.6353
INFO:name:  recall = 0.7666
INFO:name:  precision = 0.5423
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 12 Step 99 Train Loss 0.496   Accuracy 74.062 
Epoch 12 Step 199 Train Loss 0.497   Accuracy 73.344 
Epoch 12 Step 299 Train Loss 0.497   Accuracy 73.552 
Epoch 12 Step 399 Train Loss 0.497   Accuracy 73.609 
Epoch 12 Step 499 Train Loss 0.5   Accuracy 73.562 
Epoch 12 Step 599 Train Loss 0.5   Accuracy 73.604 
INFO:name:  eval_loss = 0.6813
INFO:name:  eval_acc = 0.6307
INFO:name:  f1_score = 0.6048
INFO:name:  recall = 0.6504
INFO:name:  precision = 0.5652
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 13 Step 99 Train Loss 0.485   Accuracy 75.562 
Epoch 13 Step 199 Train Loss 0.492   Accuracy 74.781 
Epoch 13 Step 299 Train Loss 0.484   Accuracy 75.406 
Epoch 13 Step 399 Train Loss 0.485   Accuracy 75.375 
Epoch 13 Step 499 Train Loss 0.485   Accuracy 75.119 
Epoch 13 Step 599 Train Loss 0.484   Accuracy 75.219 
INFO:name:  eval_loss = 0.724
INFO:name:  eval_acc = 0.6237
INFO:name:  f1_score = 0.6167
INFO:name:  recall = 0.6967
INFO:name:  precision = 0.5532
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 14 Step 99 Train Loss 0.471   Accuracy 75.531 
Epoch 14 Step 199 Train Loss 0.473   Accuracy 75.516 
Epoch 14 Step 299 Train Loss 0.473   Accuracy 75.656 
Epoch 14 Step 399 Train Loss 0.473   Accuracy 75.586 
Epoch 14 Step 499 Train Loss 0.473   Accuracy 75.569 
Epoch 14 Step 599 Train Loss 0.472   Accuracy 75.641 
INFO:name:  eval_loss = 0.7193
INFO:name:  eval_acc = 0.6281
INFO:name:  f1_score = 0.6089
INFO:name:  recall = 0.6664
INFO:name:  precision = 0.5606
INFO:name:Saving model checkpoint to ./models/final_model_defect/model.bin
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6255, 'test_f1_score': 0.6179, 'test_recall': 0.659, 'test_precision': 0.5816}
[INFO|(OpenDelta)basemodel:700]2025-01-09 04:51:30,882 >> Trainable Ratio: 2447280/225329328=1.086090%
[INFO|(OpenDelta)basemodel:702]2025-01-09 04:51:30,882 >> Delta Parameter Ratio: 2447280/225329328=1.086090%
[INFO|(OpenDelta)basemodel:704]2025-01-09 04:51:30,882 >> Static Memory 0.43 GB, Max Memory 17.11 GB
INFO:name:2.18
INFO:name:***** Running training for defect detection *****
INFO:name:  Num examples = 21854
INFO:name:  Num Epochs = 15
INFO:name:  Total train batch size  = 32
INFO:name:  Total optimization steps = 10245
train results {'train_loss': [0.689, 0.686, 0.671, 0.644, 0.622, 0.607, 0.589, 0.57, 0.557, 0.542, 0.523, 0.509, 0.5, 0.483, 0.472], 'train_acc': [53.975, 55.327, 57.897, 61.457, 63.801, 64.889, 66.574, 68.048, 69.351, 70.512, 71.716, 73.295, 73.561, 75.031, 75.675], 'eval_loss': [0.688, 0.682, 0.648, 0.628, 0.634, 0.622, 0.617, 0.633, 0.661, 0.624, 0.656, 0.693, 0.681, 0.724, 0.719], 'eval_acc': [0.548, 0.554, 0.608, 0.606, 0.599, 0.606, 0.63, 0.623, 0.615, 0.637, 0.635, 0.618, 0.631, 0.624, 0.628], 'eval_f1': [0.268, 0.398, 0.457, 0.532, 0.598, 0.61, 0.568, 0.611, 0.625, 0.583, 0.629, 0.635, 0.605, 0.617, 0.609], 'eval_precision': [0.453, 0.482, 0.574, 0.55, 0.53, 0.535, 0.576, 0.554, 0.542, 0.582, 0.563, 0.542, 0.565, 0.553, 0.561], 'eval_recall': [0.19, 0.339, 0.38, 0.515, 0.687, 0.709, 0.56, 0.682, 0.74, 0.585, 0.711, 0.767, 0.65, 0.697, 0.666]}

 [{'insert_modules': ('layer.1.DenseReluDense', 'layer.1'), 'bottleneck_dim': (64, 256), 'non_linearity': 'leakyrelu', 'dropout_rate': 0.1, 'normalization': None, 'skip_connection': True}, 0, {'insert_modules': ('layer.1.DenseReluDense', 'layer.1'), 'bottleneck_dim': (64, 128), 'non_linearity': 'gelu', 'dropout_rate': 0.0, 'normalization': None, 'skip_connection': True}, {'insert_modules': ('layer.0',), 'bottleneck_dim': (64,), 'non_linearity': 'swish', 'dropout_rate': 0.1, 'normalization': None, 'skip_connection': True}, {'insert_modules': ('layer.1.DenseReluDense',), 'bottleneck_dim': (128,), 'non_linearity': 'silu', 'dropout_rate': 0.3, 'normalization': None, 'skip_connection': True}, {'insert_modules': ('layer.1', 'layer.0', 'layer.1.DenseReluDense'), 'bottleneck_dim': (128, 64, 128), 'non_linearity': 'swish', 'dropout_rate': 0.1, 'normalization': None, 'skip_connection': True}, {'insert_modules': ('layer.0', 'layer.1.DenseReluDense'), 'bottleneck_dim': (128, 64), 'non_linearity': 'relu', 'dropout_rate': 0.25, 'normalization': 'layer_norm', 'skip_connection': True}, 0, {'insert_modules': ('layer.1.DenseReluDense', 'layer.0.SelfAttention', 'layer.0'), 'bottleneck_dim': (128, 32, 64), 'non_linearity': 'leakyrelu', 'dropout_rate': 0.1, 'normalization': None, 'skip_connection': True}, 0, {'insert_modules': ('layer.1', 'layer.0.SelfAttention'), 'bottleneck_dim': (128, 16), 'non_linearity': 'tanh', 'dropout_rate': 0.25, 'normalization': None, 'skip_connection': True}, 0] 

INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 0 Step 99 Train Loss 0.693   Accuracy 50.344 
Epoch 0 Step 199 Train Loss 0.689   Accuracy 53.172 
Epoch 0 Step 299 Train Loss 0.688   Accuracy 53.625 
Epoch 0 Step 399 Train Loss 0.688   Accuracy 53.945 
Epoch 0 Step 499 Train Loss 0.688   Accuracy 53.962 
Epoch 0 Step 599 Train Loss 0.688   Accuracy 54.156 
INFO:name:  eval_loss = 0.6875
INFO:name:  eval_acc = 0.5337
INFO:name:  f1_score = 0.3916
INFO:name:  recall = 0.3454
INFO:name:  precision = 0.452
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.5337
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.5344, 'test_f1_score': 0.4229, 'test_recall': 0.3713, 'test_precision': 0.491}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 1 Step 99 Train Loss 0.685   Accuracy 55.844 
Epoch 1 Step 199 Train Loss 0.686   Accuracy 55.312 
Epoch 1 Step 299 Train Loss 0.685   Accuracy 55.708 
Epoch 1 Step 399 Train Loss 0.685   Accuracy 55.883 
Epoch 1 Step 499 Train Loss 0.685   Accuracy 55.6 
Epoch 1 Step 599 Train Loss 0.685   Accuracy 55.719 
INFO:name:  eval_loss = 0.6828
INFO:name:  eval_acc = 0.5553
INFO:name:  f1_score = 0.4189
INFO:name:  recall = 0.369
INFO:name:  precision = 0.4845
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.5553
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.5597, 'test_f1_score': 0.4474, 'test_recall': 0.388, 'test_precision': 0.5282}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 2 Step 99 Train Loss 0.677   Accuracy 57.125 
Epoch 2 Step 199 Train Loss 0.675   Accuracy 57.688 
Epoch 2 Step 299 Train Loss 0.674   Accuracy 57.49 
Epoch 2 Step 399 Train Loss 0.671   Accuracy 57.703 
Epoch 2 Step 499 Train Loss 0.668   Accuracy 58.094 
Epoch 2 Step 599 Train Loss 0.664   Accuracy 58.661 
INFO:name:  eval_loss = 0.6376
INFO:name:  eval_acc = 0.6116
INFO:name:  f1_score = 0.322
INFO:name:  recall = 0.2123
INFO:name:  precision = 0.6667
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6116
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.5948, 'test_f1_score': 0.3213, 'test_recall': 0.2088, 'test_precision': 0.6968}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 3 Step 99 Train Loss 0.629   Accuracy 63.719 
Epoch 3 Step 199 Train Loss 0.631   Accuracy 62.812 
Epoch 3 Step 299 Train Loss 0.63   Accuracy 63.115 
Epoch 3 Step 399 Train Loss 0.63   Accuracy 63.023 
Epoch 3 Step 499 Train Loss 0.628   Accuracy 63.175 
Epoch 3 Step 599 Train Loss 0.628   Accuracy 63.099 
INFO:name:  eval_loss = 0.6322
INFO:name:  eval_acc = 0.627
INFO:name:  f1_score = 0.4908
INFO:name:  recall = 0.4136
INFO:name:  precision = 0.6032
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.627
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6171, 'test_f1_score': 0.5014, 'test_recall': 0.4191, 'test_precision': 0.624}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 4 Step 99 Train Loss 0.609   Accuracy 64.094 
Epoch 4 Step 199 Train Loss 0.604   Accuracy 64.688 
Epoch 4 Step 299 Train Loss 0.604   Accuracy 64.802 
Epoch 4 Step 399 Train Loss 0.6   Accuracy 65.211 
Epoch 4 Step 499 Train Loss 0.6   Accuracy 65.538 
Epoch 4 Step 599 Train Loss 0.597   Accuracy 65.823 
INFO:name:  eval_loss = 0.6042
INFO:name:  eval_acc = 0.6431
INFO:name:  f1_score = 0.5909
INFO:name:  recall = 0.5931
INFO:name:  precision = 0.5886
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6431
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6215, 'test_f1_score': 0.5841, 'test_recall': 0.5785, 'test_precision': 0.5898}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 5 Step 99 Train Loss 0.59   Accuracy 67.188 
Epoch 5 Step 199 Train Loss 0.588   Accuracy 66.938 
Epoch 5 Step 299 Train Loss 0.579   Accuracy 67.51 
Epoch 5 Step 399 Train Loss 0.577   Accuracy 67.711 
Epoch 5 Step 499 Train Loss 0.579   Accuracy 67.375 
Epoch 5 Step 599 Train Loss 0.58   Accuracy 67.328 
INFO:name:  eval_loss = 0.6043
INFO:name:  eval_acc = 0.6515
INFO:name:  f1_score = 0.5784
INFO:name:  recall = 0.5501
INFO:name:  precision = 0.6097
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6515
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6274, 'test_f1_score': 0.5737, 'test_recall': 0.5458, 'test_precision': 0.6046}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 6 Step 99 Train Loss 0.559   Accuracy 70.094 
Epoch 6 Step 199 Train Loss 0.554   Accuracy 69.969 
Epoch 6 Step 299 Train Loss 0.553   Accuracy 69.833 
Epoch 6 Step 399 Train Loss 0.555   Accuracy 69.492 
Epoch 6 Step 499 Train Loss 0.554   Accuracy 69.375 
Epoch 6 Step 599 Train Loss 0.555   Accuracy 69.234 
INFO:name:  eval_loss = 0.6226
INFO:name:  eval_acc = 0.6545
INFO:name:  f1_score = 0.6112
INFO:name:  recall = 0.6251
INFO:name:  precision = 0.5979
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6545
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6321, 'test_f1_score': 0.6088, 'test_recall': 0.6231, 'test_precision': 0.5951}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 7 Step 99 Train Loss 0.548   Accuracy 70.438 
Epoch 7 Step 199 Train Loss 0.536   Accuracy 70.984 
Epoch 7 Step 299 Train Loss 0.534   Accuracy 70.99 
Epoch 7 Step 399 Train Loss 0.534   Accuracy 71.055 
Epoch 7 Step 499 Train Loss 0.532   Accuracy 71.362 
Epoch 7 Step 599 Train Loss 0.533   Accuracy 71.302 
INFO:name:  eval_loss = 0.6284
INFO:name:  eval_acc = 0.6493
INFO:name:  f1_score = 0.6048
INFO:name:  recall = 0.6175
INFO:name:  precision = 0.5926
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 8 Step 99 Train Loss 0.509   Accuracy 72.562 
Epoch 8 Step 199 Train Loss 0.514   Accuracy 72.859 
Epoch 8 Step 299 Train Loss 0.516   Accuracy 72.698 
Epoch 8 Step 399 Train Loss 0.514   Accuracy 72.773 
Epoch 8 Step 499 Train Loss 0.513   Accuracy 72.644 
Epoch 8 Step 599 Train Loss 0.512   Accuracy 72.682 
INFO:name:  eval_loss = 0.6318
INFO:name:  eval_acc = 0.6504
INFO:name:  f1_score = 0.5875
INFO:name:  recall = 0.5729
INFO:name:  precision = 0.6028
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 9 Step 99 Train Loss 0.489   Accuracy 73.906 
Epoch 9 Step 199 Train Loss 0.484   Accuracy 74.281 
Epoch 9 Step 299 Train Loss 0.49   Accuracy 73.969 
Epoch 9 Step 399 Train Loss 0.488   Accuracy 74.164 
Epoch 9 Step 499 Train Loss 0.491   Accuracy 74.038 
Epoch 9 Step 599 Train Loss 0.495   Accuracy 73.776 
INFO:name:  eval_loss = 0.6579
INFO:name:  eval_acc = 0.6563
INFO:name:  f1_score = 0.6056
INFO:name:  recall = 0.6074
INFO:name:  precision = 0.6039
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6563
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6234, 'test_f1_score': 0.5954, 'test_recall': 0.6032, 'test_precision': 0.5877}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 10 Step 99 Train Loss 0.473   Accuracy 75.344 
Epoch 10 Step 199 Train Loss 0.468   Accuracy 75.891 
Epoch 10 Step 299 Train Loss 0.472   Accuracy 75.365 
Epoch 10 Step 399 Train Loss 0.475   Accuracy 75.07 
Epoch 10 Step 499 Train Loss 0.477   Accuracy 74.962 
Epoch 10 Step 599 Train Loss 0.476   Accuracy 75.12 
INFO:name:  eval_loss = 0.6693
INFO:name:  eval_acc = 0.6519
INFO:name:  f1_score = 0.6201
INFO:name:  recall = 0.6537
INFO:name:  precision = 0.5897
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 11 Step 99 Train Loss 0.447   Accuracy 76.281 
Epoch 11 Step 199 Train Loss 0.454   Accuracy 76.344 
Epoch 11 Step 299 Train Loss 0.458   Accuracy 76.01 
Epoch 11 Step 399 Train Loss 0.457   Accuracy 76.258 
Epoch 11 Step 499 Train Loss 0.456   Accuracy 76.225 
Epoch 11 Step 599 Train Loss 0.46   Accuracy 75.958 
INFO:name:  eval_loss = 0.7078
INFO:name:  eval_acc = 0.6413
INFO:name:  f1_score = 0.6237
INFO:name:  recall = 0.6841
INFO:name:  precision = 0.573
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 12 Step 99 Train Loss 0.444   Accuracy 76.75 
Epoch 12 Step 199 Train Loss 0.441   Accuracy 77.094 
Epoch 12 Step 299 Train Loss 0.445   Accuracy 77.021 
Epoch 12 Step 399 Train Loss 0.443   Accuracy 77.109 
Epoch 12 Step 499 Train Loss 0.443   Accuracy 77.138 
Epoch 12 Step 599 Train Loss 0.443   Accuracy 77.12 
INFO:name:  eval_loss = 0.6897
INFO:name:  eval_acc = 0.657
INFO:name:  f1_score = 0.6177
INFO:name:  recall = 0.6377
INFO:name:  precision = 0.5989
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.657
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6179, 'test_f1_score': 0.5985, 'test_recall': 0.6199, 'test_precision': 0.5784}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 13 Step 99 Train Loss 0.422   Accuracy 78.938 
Epoch 13 Step 199 Train Loss 0.431   Accuracy 77.953 
Epoch 13 Step 299 Train Loss 0.435   Accuracy 77.802 
Epoch 13 Step 399 Train Loss 0.432   Accuracy 77.898 
Epoch 13 Step 499 Train Loss 0.428   Accuracy 78.094 
Epoch 13 Step 599 Train Loss 0.428   Accuracy 78.083 
INFO:name:  eval_loss = 0.7833
INFO:name:  eval_acc = 0.6435
INFO:name:  f1_score = 0.6358
INFO:name:  recall = 0.7161
INFO:name:  precision = 0.5716
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 14 Step 99 Train Loss 0.406   Accuracy 79.125 
Epoch 14 Step 199 Train Loss 0.405   Accuracy 79.328 
Epoch 14 Step 299 Train Loss 0.412   Accuracy 79.062 
Epoch 14 Step 399 Train Loss 0.413   Accuracy 79.086 
Epoch 14 Step 499 Train Loss 0.417   Accuracy 78.762 
Epoch 14 Step 599 Train Loss 0.418   Accuracy 78.734 
INFO:name:  eval_loss = 0.7429
INFO:name:  eval_acc = 0.653
INFO:name:  f1_score = 0.6118
INFO:name:  recall = 0.6293
INFO:name:  precision = 0.5952
INFO:name:Saving model checkpoint to ./models/final_model_defect/model.bin
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6127, 'test_f1_score': 0.5924, 'test_recall': 0.6127, 'test_precision': 0.5735}
train results {'train_loss': [0.688, 0.685, 0.663, 0.627, 0.599, 0.579, 0.554, 0.534, 0.513, 0.493, 0.475, 0.461, 0.445, 0.427, 0.419], 'train_acc': [54.179, 55.797, 58.686, 63.088, 65.548, 67.2, 69.366, 71.255, 72.569, 73.767, 75.18, 75.905, 77.006, 78.115, 78.608], 'eval_loss': [0.688, 0.683, 0.638, 0.632, 0.604, 0.604, 0.623, 0.628, 0.632, 0.658, 0.669, 0.708, 0.69, 0.783, 0.743], 'eval_acc': [0.534, 0.555, 0.612, 0.627, 0.643, 0.652, 0.654, 0.649, 0.65, 0.656, 0.652, 0.641, 0.657, 0.644, 0.653], 'eval_f1': [0.392, 0.419, 0.322, 0.491, 0.591, 0.578, 0.611, 0.605, 0.588, 0.606, 0.62, 0.624, 0.618, 0.636, 0.612], 'eval_precision': [0.452, 0.484, 0.667, 0.603, 0.589, 0.61, 0.598, 0.593, 0.603, 0.604, 0.59, 0.573, 0.599, 0.572, 0.595], 'eval_recall': [0.345, 0.369, 0.212, 0.414, 0.593, 0.55, 0.625, 0.618, 0.573, 0.607, 0.654, 0.684, 0.638, 0.716, 0.629]}
