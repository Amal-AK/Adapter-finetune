/opt/miniconda3/envs/adapter/lib/python3.10/site-packages/transformers/utils/generic.py:260: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  torch.utils._pytree._register_pytree_node(
INFO:name:device: cuda:1, n_gpu: 1
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /microsoft/unixcoder-base/resolve/main/config.json HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /microsoft/unixcoder-base/resolve/main/vocab.json HTTP/1.1" 200 0
[INFO|(OpenDelta)basemodel:700]2024-12-30 02:53:57,341 >> Trainable Ratio: 1066128/126995856=0.839498%
[INFO|(OpenDelta)basemodel:702]2024-12-30 02:53:57,341 >> Delta Parameter Ratio: 1066128/126995856=0.839498%
[INFO|(OpenDelta)basemodel:704]2024-12-30 02:53:57,341 >> Static Memory 0.00 GB, Max Memory 0.00 GB


 [{'insert_modules': ('attention.self', 'intermediate', 'output'), 'bottleneck_dim': (16, 64, 128), 'non_linearity': 'gelu', 'dropout_rate': 0.2, 'normalization': 'layer_norm', 'skip_connection': True}, 0, 0, {'insert_modules': ('intermediate', 'attention.self'), 'bottleneck_dim': (64, 32), 'non_linearity': 'swish', 'dropout_rate': 0.3, 'normalization': 'layer_norm', 'skip_connection': True}, 0, 0, 0, 0, 0, 0, 0, 0] 

INFO:name:***** Running training for defect detection *****
INFO:name:  Num examples = 21854
INFO:name:  Num Epochs = 15
INFO:name:  Total train batch size  = 32
INFO:name:  Total optimization steps = 10245
Epoch 0 Step 99 Train Loss 0.694   Accuracy 51.281 
Epoch 0 Step 199 Train Loss 0.692   Accuracy 51.875 
Epoch 0 Step 299 Train Loss 0.689   Accuracy 53.302 
Epoch 0 Step 399 Train Loss 0.688   Accuracy 53.352 
Epoch 0 Step 499 Train Loss 0.687   Accuracy 53.694 
Epoch 0 Step 599 Train Loss 0.685   Accuracy 54.266 
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
INFO:name:  eval_loss = 0.6792
INFO:name:  eval_acc = 0.5736
INFO:name:  f1_score = 0.0628
INFO:name:  recall = 0.0329
INFO:name:  precision = 0.6964
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.5736
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.5494, 'test_f1_score': 0.048, 'test_recall': 0.0247, 'test_precision': 0.8158}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 1 Step 99 Train Loss 0.667   Accuracy 58.125 
Epoch 1 Step 199 Train Loss 0.664   Accuracy 58.938 
Epoch 1 Step 299 Train Loss 0.664   Accuracy 58.583 
Epoch 1 Step 399 Train Loss 0.664   Accuracy 58.406 
Epoch 1 Step 499 Train Loss 0.662   Accuracy 58.681 
Epoch 1 Step 599 Train Loss 0.66   Accuracy 59.115 
INFO:name:  eval_loss = 0.6602
INFO:name:  eval_acc = 0.5878
INFO:name:  f1_score = 0.6162
INFO:name:  recall = 0.7616
INFO:name:  precision = 0.5175
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.5878
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.5878, 'test_f1_score': 0.6262, 'test_recall': 0.7514, 'test_precision': 0.5367}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 2 Step 99 Train Loss 0.629   Accuracy 63.875 
Epoch 2 Step 199 Train Loss 0.632   Accuracy 63.062 
Epoch 2 Step 299 Train Loss 0.631   Accuracy 63.042 
Epoch 2 Step 399 Train Loss 0.63   Accuracy 62.844 
Epoch 2 Step 499 Train Loss 0.631   Accuracy 62.719 
Epoch 2 Step 599 Train Loss 0.63   Accuracy 62.646 
INFO:name:  eval_loss = 0.6341
INFO:name:  eval_acc = 0.6193
INFO:name:  f1_score = 0.6341
INFO:name:  recall = 0.7591
INFO:name:  precision = 0.5444
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6193
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6069, 'test_f1_score': 0.6319, 'test_recall': 0.7347, 'test_precision': 0.5544}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 3 Step 99 Train Loss 0.6   Accuracy 65.719 
Epoch 3 Step 199 Train Loss 0.6   Accuracy 65.906 
Epoch 3 Step 299 Train Loss 0.603   Accuracy 65.583 
Epoch 3 Step 399 Train Loss 0.601   Accuracy 65.766 
Epoch 3 Step 499 Train Loss 0.601   Accuracy 65.656 
Epoch 3 Step 599 Train Loss 0.603   Accuracy 65.453 
INFO:name:  eval_loss = 0.6218
INFO:name:  eval_acc = 0.6354
INFO:name:  f1_score = 0.535
INFO:name:  recall = 0.4827
INFO:name:  precision = 0.6
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6354
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6245, 'test_f1_score': 0.5403, 'test_recall': 0.4805, 'test_precision': 0.6172}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 4 Step 99 Train Loss 0.572   Accuracy 67.375 
Epoch 4 Step 199 Train Loss 0.581   Accuracy 67.297 
Epoch 4 Step 299 Train Loss 0.58   Accuracy 67.542 
Epoch 4 Step 399 Train Loss 0.581   Accuracy 67.602 
Epoch 4 Step 499 Train Loss 0.581   Accuracy 67.7 
Epoch 4 Step 599 Train Loss 0.591   Accuracy 66.677 
INFO:name:  eval_loss = 0.6224
INFO:name:  eval_acc = 0.6358
INFO:name:  f1_score = 0.5996
INFO:name:  recall = 0.6276
INFO:name:  precision = 0.574
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6358
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6288, 'test_f1_score': 0.6051, 'test_recall': 0.6191, 'test_precision': 0.5918}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 5 Step 99 Train Loss 0.596   Accuracy 66.406 
Epoch 5 Step 199 Train Loss 0.587   Accuracy 66.453 
Epoch 5 Step 299 Train Loss 0.582   Accuracy 67.104 
Epoch 5 Step 399 Train Loss 0.581   Accuracy 67.289 
Epoch 5 Step 499 Train Loss 0.58   Accuracy 67.475 
Epoch 5 Step 599 Train Loss 0.577   Accuracy 67.839 
INFO:name:  eval_loss = 0.6265
INFO:name:  eval_acc = 0.6479
INFO:name:  f1_score = 0.5228
INFO:name:  recall = 0.444
INFO:name:  precision = 0.6357
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6479
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6446, 'test_f1_score': 0.5347, 'test_recall': 0.4446, 'test_precision': 0.6707}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 6 Step 99 Train Loss 0.56   Accuracy 68.719 
Epoch 6 Step 199 Train Loss 0.568   Accuracy 68.172 
Epoch 6 Step 299 Train Loss 0.572   Accuracy 68.188 
Epoch 6 Step 399 Train Loss 0.57   Accuracy 68.594 
Epoch 6 Step 499 Train Loss 0.571   Accuracy 68.494 
Epoch 6 Step 599 Train Loss 0.57   Accuracy 68.484 
INFO:name:  eval_loss = 0.6256
INFO:name:  eval_acc = 0.6574
INFO:name:  f1_score = 0.553
INFO:name:  recall = 0.4878
INFO:name:  precision = 0.6384
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6574
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6343, 'test_f1_score': 0.539, 'test_recall': 0.4653, 'test_precision': 0.6404}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 7 Step 99 Train Loss 0.556   Accuracy 68.469 
Epoch 7 Step 199 Train Loss 0.552   Accuracy 69.578 
Epoch 7 Step 299 Train Loss 0.548   Accuracy 70.052 
Epoch 7 Step 399 Train Loss 0.552   Accuracy 69.82 
Epoch 7 Step 499 Train Loss 0.549   Accuracy 70.031 
Epoch 7 Step 599 Train Loss 0.551   Accuracy 69.974 
INFO:name:  eval_loss = 0.617
INFO:name:  eval_acc = 0.6607
INFO:name:  f1_score = 0.5292
INFO:name:  recall = 0.4389
INFO:name:  precision = 0.6662
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6607
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6329, 'test_f1_score': 0.5185, 'test_recall': 0.4303, 'test_precision': 0.6522}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 8 Step 99 Train Loss 0.537   Accuracy 71.156 
Epoch 8 Step 199 Train Loss 0.537   Accuracy 70.719 
Epoch 8 Step 299 Train Loss 0.536   Accuracy 70.75 
Epoch 8 Step 399 Train Loss 0.536   Accuracy 70.555 
Epoch 8 Step 499 Train Loss 0.535   Accuracy 70.562 
Epoch 8 Step 599 Train Loss 0.534   Accuracy 70.708 
INFO:name:  eval_loss = 0.62
INFO:name:  eval_acc = 0.653
INFO:name:  f1_score = 0.5503
INFO:name:  recall = 0.4886
INFO:name:  precision = 0.6298
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 9 Step 99 Train Loss 0.515   Accuracy 73.531 
Epoch 9 Step 199 Train Loss 0.513   Accuracy 73.531 
Epoch 9 Step 299 Train Loss 0.512   Accuracy 72.74 
Epoch 9 Step 399 Train Loss 0.52   Accuracy 72.148 
Epoch 9 Step 499 Train Loss 0.52   Accuracy 72.119 
Epoch 9 Step 599 Train Loss 0.519   Accuracy 72.146 
INFO:name:  eval_loss = 0.6358
INFO:name:  eval_acc = 0.653
INFO:name:  f1_score = 0.5734
INFO:name:  recall = 0.5366
INFO:name:  precision = 0.6155
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 10 Step 99 Train Loss 0.505   Accuracy 73.344 
Epoch 10 Step 199 Train Loss 0.511   Accuracy 72.594 
Epoch 10 Step 299 Train Loss 0.511   Accuracy 72.688 
Epoch 10 Step 399 Train Loss 0.508   Accuracy 72.93 
Epoch 10 Step 499 Train Loss 0.508   Accuracy 72.962 
Epoch 10 Step 599 Train Loss 0.509   Accuracy 72.922 
INFO:name:  eval_loss = 0.626
INFO:name:  eval_acc = 0.6603
INFO:name:  f1_score = 0.5897
INFO:name:  recall = 0.5619
INFO:name:  precision = 0.6205
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 11 Step 99 Train Loss 0.485   Accuracy 73.844 
Epoch 11 Step 199 Train Loss 0.489   Accuracy 73.828 
Epoch 11 Step 299 Train Loss 0.49   Accuracy 73.656 
Epoch 11 Step 399 Train Loss 0.493   Accuracy 73.609 
Epoch 11 Step 499 Train Loss 0.49   Accuracy 73.862 
Epoch 11 Step 599 Train Loss 0.487   Accuracy 74.089 
INFO:name:  eval_loss = 0.6439
INFO:name:  eval_acc = 0.6625
INFO:name:  f1_score = 0.5843
INFO:name:  recall = 0.5459
INFO:name:  precision = 0.6285
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6625
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6439, 'test_f1_score': 0.5712, 'test_recall': 0.5163, 'test_precision': 0.6391}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 12 Step 99 Train Loss 0.473   Accuracy 75.219 
Epoch 12 Step 199 Train Loss 0.475   Accuracy 75.141 
Epoch 12 Step 299 Train Loss 0.476   Accuracy 75.167 
Epoch 12 Step 399 Train Loss 0.478   Accuracy 74.992 
Epoch 12 Step 499 Train Loss 0.481   Accuracy 74.825 
Epoch 12 Step 599 Train Loss 0.482   Accuracy 74.599 
INFO:name:  eval_loss = 0.6654
INFO:name:  eval_acc = 0.6515
INFO:name:  f1_score = 0.5956
INFO:name:  recall = 0.5906
INFO:name:  precision = 0.6007
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 13 Step 99 Train Loss 0.453   Accuracy 75.844 
Epoch 13 Step 199 Train Loss 0.458   Accuracy 75.703 
Epoch 13 Step 299 Train Loss 0.462   Accuracy 75.76 
Epoch 13 Step 399 Train Loss 0.464   Accuracy 75.945 
Epoch 13 Step 499 Train Loss 0.468   Accuracy 75.619 
Epoch 13 Step 599 Train Loss 0.466   Accuracy 75.635 
INFO:name:  eval_loss = 0.6643
INFO:name:  eval_acc = 0.6592
INFO:name:  f1_score = 0.5789
INFO:name:  recall = 0.5392
INFO:name:  precision = 0.625
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 14 Step 99 Train Loss 0.455   Accuracy 77.344 
Epoch 14 Step 199 Train Loss 0.459   Accuracy 76.5 
Epoch 14 Step 299 Train Loss 0.457   Accuracy 76.281 
Epoch 14 Step 399 Train Loss 0.458   Accuracy 76.266 
Epoch 14 Step 499 Train Loss 0.459   Accuracy 76.119 
Epoch 14 Step 599 Train Loss 0.46   Accuracy 76.135 
INFO:name:  eval_loss = 0.6752
INFO:name:  eval_acc = 0.6574
INFO:name:  f1_score = 0.578
INFO:name:  recall = 0.54
INFO:name:  precision = 0.6217
INFO:name:Saving model checkpoint to ./models/final_model_defect/model.bin
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.638, 'test_f1_score': 0.5653, 'test_recall': 0.5124, 'test_precision': 0.6304}

train results {'train_loss': [0.684, 0.659, 0.63, 0.603, 0.593, 0.577, 0.568, 0.553, 0.534, 0.519, 0.509, 0.489, 0.481, 0.467, 0.461], 'train_acc': [54.658, 59.371, 62.697, 65.419, 66.446, 67.855, 68.554, 69.765, 70.709, 72.132, 72.856, 73.899, 74.778, 75.565, 76.118], 'eval_loss': [0.679, 0.66, 0.634, 0.622, 0.622, 0.626, 0.626, 0.617, 0.62, 0.636, 0.626, 0.644, 0.665, 0.664, 0.675], 'eval_acc': [0.574, 0.588, 0.619, 0.635, 0.636, 0.648, 0.657, 0.661, 0.653, 0.653, 0.66, 0.662, 0.652, 0.659, 0.657], 'eval_f1': [0.063, 0.616, 0.634, 0.535, 0.6, 0.523, 0.553, 0.529, 0.55, 0.573, 0.59, 0.584, 0.596, 0.579, 0.578], 'eval_precision': [0.696, 0.518, 0.544, 0.6, 0.574, 0.636, 0.638, 0.666, 0.63, 0.616, 0.62, 0.628, 0.601, 0.625, 0.622], 'eval_recall': [0.033, 0.762, 0.759, 0.483, 0.628, 0.444, 0.488, 0.439, 0.489, 0.537, 0.562, 0.546, 0.591, 0.539, 0.54]}














 [{'insert_modules': ('attention.self', 'intermediate', 'output'), 'bottleneck_dim': (16, 64, 128), 'non_linearity': 'gelu', 'dropout_rate': 0.2, 'normalization': 'layer_norm', 'skip_connection': True}, 0, 0, {'insert_modules': ('intermediate', 'attention.self'), 'bottleneck_dim': (64, 32), 'non_linearity': 'swish', 'dropout_rate': 0.3, 'normalization': 'layer_norm', 'skip_connection': True}, 0, 0, {'insert_modules': ('attention.self', 'output'), 'bottleneck_dim': (32, 128), 'non_linearity': 'silu', 'dropout_rate': 0.25, 'normalization': 'layer_norm', 'skip_connection': True}, 0, 0, 0, 0, 0] 
[INFO|(OpenDelta)basemodel:700]2024-12-30 04:38:56,061 >> Trainable Ratio: 1313904/127243632=1.032589%
[INFO|(OpenDelta)basemodel:702]2024-12-30 04:38:56,061 >> Delta Parameter Ratio: 1313904/127243632=1.032589%
[INFO|(OpenDelta)basemodel:704]2024-12-30 04:38:56,061 >> Static Memory 0.49 GB, Max Memory 15.99 GB
INFO:name:***** Running training for defect detection *****
INFO:name:  Num examples = 21854
INFO:name:  Num Epochs = 15
INFO:name:  Total train batch size  = 32
INFO:name:  Total optimization steps = 10245
INFO:name:
Epoch 0 Step 99 Train Loss 0.69   Accuracy 53.938 
Epoch 0 Step 199 Train Loss 0.689   Accuracy 54.312 
Epoch 0 Step 299 Train Loss 0.686   Accuracy 54.958 
Epoch 0 Step 399 Train Loss 0.687   Accuracy 54.992 
Epoch 0 Step 499 Train Loss 0.686   Accuracy 55.181 
Epoch 0 Step 599 Train Loss 0.683   Accuracy 55.703 
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
INFO:name:  eval_loss = 0.6634
INFO:name:  eval_acc = 0.5846
INFO:name:  f1_score = 0.4608
INFO:name:  recall = 0.4086
INFO:name:  precision = 0.5283
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.5846
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.5714, 'test_f1_score': 0.4611, 'test_recall': 0.3992, 'test_precision': 0.5458}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 1 Step 99 Train Loss 0.664   Accuracy 59.781 
Epoch 1 Step 199 Train Loss 0.656   Accuracy 60.328 
Epoch 1 Step 299 Train Loss 0.657   Accuracy 59.938 
Epoch 1 Step 399 Train Loss 0.661   Accuracy 59.305 
Epoch 1 Step 499 Train Loss 0.662   Accuracy 59.344 
Epoch 1 Step 599 Train Loss 0.66   Accuracy 59.708 
INFO:name:  eval_loss = 0.6655
INFO:name:  eval_acc = 0.5644
INFO:name:  f1_score = 0.6284
INFO:name:  recall = 0.8475
INFO:name:  precision = 0.4993
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 2 Step 99 Train Loss 0.647   Accuracy 60.688 
Epoch 2 Step 199 Train Loss 0.647   Accuracy 61.453 
Epoch 2 Step 299 Train Loss 0.642   Accuracy 61.854 
Epoch 2 Step 399 Train Loss 0.64   Accuracy 61.898 
Epoch 2 Step 499 Train Loss 0.64   Accuracy 61.712 
Epoch 2 Step 599 Train Loss 0.641   Accuracy 61.677 
INFO:name:  eval_loss = 0.6283
INFO:name:  eval_acc = 0.6157
INFO:name:  f1_score = 0.607
INFO:name:  recall = 0.6832
INFO:name:  precision = 0.5461
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6157
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6003, 'test_f1_score': 0.5997, 'test_recall': 0.6518, 'test_precision': 0.5553}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 3 Step 99 Train Loss 0.622   Accuracy 63.562 
Epoch 3 Step 199 Train Loss 0.619   Accuracy 63.938 
Epoch 3 Step 299 Train Loss 0.616   Accuracy 64.219 
Epoch 3 Step 399 Train Loss 0.618   Accuracy 63.758 
Epoch 3 Step 499 Train Loss 0.616   Accuracy 64.019 
Epoch 3 Step 599 Train Loss 0.617   Accuracy 63.807 
INFO:name:  eval_loss = 0.6325
INFO:name:  eval_acc = 0.6215
INFO:name:  f1_score = 0.6086
INFO:name:  recall = 0.6773
INFO:name:  precision = 0.5526
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6215
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6201, 'test_f1_score': 0.6175, 'test_recall': 0.6677, 'test_precision': 0.5744}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 4 Step 99 Train Loss 0.595   Accuracy 65.688 
Epoch 4 Step 199 Train Loss 0.596   Accuracy 64.859 
Epoch 4 Step 299 Train Loss 0.592   Accuracy 65.396 
Epoch 4 Step 399 Train Loss 0.595   Accuracy 65.406 
Epoch 4 Step 499 Train Loss 0.595   Accuracy 65.431 
Epoch 4 Step 599 Train Loss 0.596   Accuracy 65.464 
INFO:name:  eval_loss = 0.6086
INFO:name:  eval_acc = 0.6482
INFO:name:  f1_score = 0.429
INFO:name:  recall = 0.3041
INFO:name:  precision = 0.7278
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6482
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6146, 'test_f1_score': 0.391, 'test_recall': 0.2693, 'test_precision': 0.7131}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 5 Step 99 Train Loss 0.59   Accuracy 66.188 
Epoch 5 Step 199 Train Loss 0.588   Accuracy 66.141 
Epoch 5 Step 299 Train Loss 0.584   Accuracy 66.385 
Epoch 5 Step 399 Train Loss 0.58   Accuracy 66.719 
Epoch 5 Step 499 Train Loss 0.578   Accuracy 66.931 
Epoch 5 Step 599 Train Loss 0.579   Accuracy 66.974 
INFO:name:  eval_loss = 0.7221
INFO:name:  eval_acc = 0.5692
INFO:name:  f1_score = 0.6469
INFO:name:  recall = 0.9082
INFO:name:  precision = 0.5023
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 6 Step 99 Train Loss 0.563   Accuracy 68.594 
Epoch 6 Step 199 Train Loss 0.559   Accuracy 68.984 
Epoch 6 Step 299 Train Loss 0.562   Accuracy 68.906 
Epoch 6 Step 399 Train Loss 0.563   Accuracy 68.969 
Epoch 6 Step 499 Train Loss 0.56   Accuracy 69.025 
Epoch 6 Step 599 Train Loss 0.561   Accuracy 68.76 
INFO:name:  eval_loss = 0.612
INFO:name:  eval_acc = 0.6515
INFO:name:  f1_score = 0.5788
INFO:name:  recall = 0.551
INFO:name:  precision = 0.6095
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6515
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6442, 'test_f1_score': 0.5857, 'test_recall': 0.5474, 'test_precision': 0.6297}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 7 Step 99 Train Loss 0.534   Accuracy 71.562 
Epoch 7 Step 199 Train Loss 0.53   Accuracy 71.031 
Epoch 7 Step 299 Train Loss 0.534   Accuracy 70.719 
Epoch 7 Step 399 Train Loss 0.535   Accuracy 70.406 
Epoch 7 Step 499 Train Loss 0.537   Accuracy 70.144 
Epoch 7 Step 599 Train Loss 0.539   Accuracy 70.062 
INFO:name:  eval_loss = 0.6055
INFO:name:  eval_acc = 0.6471
INFO:name:  f1_score = 0.6119
INFO:name:  recall = 0.6403
INFO:name:  precision = 0.586
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 8 Step 99 Train Loss 0.51   Accuracy 71.75 
Epoch 8 Step 199 Train Loss 0.517   Accuracy 71.5 
Epoch 8 Step 299 Train Loss 0.52   Accuracy 71.198 
Epoch 8 Step 399 Train Loss 0.523   Accuracy 71.156 
Epoch 8 Step 499 Train Loss 0.523   Accuracy 71.181 
Epoch 8 Step 599 Train Loss 0.523   Accuracy 71.12 
INFO:name:  eval_loss = 0.6285
INFO:name:  eval_acc = 0.6622
INFO:name:  f1_score = 0.6081
INFO:name:  recall = 0.6032
INFO:name:  precision = 0.613
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6622
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6428, 'test_f1_score': 0.6074, 'test_recall': 0.6016, 'test_precision': 0.6133}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 9 Step 99 Train Loss 0.52   Accuracy 71.781 
Epoch 9 Step 199 Train Loss 0.511   Accuracy 72.359 
Epoch 9 Step 299 Train Loss 0.508   Accuracy 72.5 
Epoch 9 Step 399 Train Loss 0.51   Accuracy 72.328 
Epoch 9 Step 499 Train Loss 0.511   Accuracy 72.25 
Epoch 9 Step 599 Train Loss 0.51   Accuracy 72.333 
INFO:name:  eval_loss = 0.6127
INFO:name:  eval_acc = 0.6622
INFO:name:  f1_score = 0.5818
INFO:name:  recall = 0.5409
INFO:name:  precision = 0.6294
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 10 Step 99 Train Loss 0.492   Accuracy 74.094 
Epoch 10 Step 199 Train Loss 0.496   Accuracy 73.609 
Epoch 10 Step 299 Train Loss 0.492   Accuracy 73.698 
Epoch 10 Step 399 Train Loss 0.49   Accuracy 74.062 
Epoch 10 Step 499 Train Loss 0.489   Accuracy 74.119 
Epoch 10 Step 599 Train Loss 0.488   Accuracy 74.182 
INFO:name:  eval_loss = 0.6768
INFO:name:  eval_acc = 0.6501
INFO:name:  f1_score = 0.598
INFO:name:  recall = 0.599
INFO:name:  precision = 0.597
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 11 Step 99 Train Loss 0.474   Accuracy 75.156 
Epoch 11 Step 199 Train Loss 0.472   Accuracy 75.688 
Epoch 11 Step 299 Train Loss 0.472   Accuracy 75.656 
Epoch 11 Step 399 Train Loss 0.473   Accuracy 75.188 
Epoch 11 Step 499 Train Loss 0.471   Accuracy 75.175 
Epoch 11 Step 599 Train Loss 0.473   Accuracy 75.031 
INFO:name:  eval_loss = 0.6852
INFO:name:  eval_acc = 0.657
INFO:name:  f1_score = 0.6055
INFO:name:  recall = 0.6057
INFO:name:  precision = 0.6052
INFO:name:Saving model checkpoint to ./models/final_model_defect/model.bin
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6457, 'test_f1_score': 0.6137, 'test_recall': 0.6127, 'test_precision': 0.6147}

train results {'train_loss': [0.683, 0.658, 0.642, 0.616, 0.598, 0.582, 0.562, 0.543, 0.525, 0.51, 0.489, 0.473], 'train_acc': [55.752, 60.026, 61.507, 63.85, 65.41, 66.677, 68.816, 69.786, 70.967, 72.399, 73.964, 74.874], 'eval_loss': [0.663, 0.665, 0.628, 0.632, 0.609, 0.722, 0.612, 0.606, 0.628, 0.613, 0.677, 0.685], 'eval_acc': [0.585, 0.564, 0.616, 0.622, 0.648, 0.569, 0.652, 0.647, 0.662, 0.662, 0.65, 0.657], 'eval_f1': [0.461, 0.628, 0.607, 0.609, 0.429, 0.647, 0.579, 0.612, 0.608, 0.582, 0.598, 0.606], 'eval_precision': [0.528, 0.499, 0.546, 0.553, 0.728, 0.502, 0.61, 0.586, 0.613, 0.629, 0.597, 0.605], 'eval_recall': [0.409, 0.848, 0.683, 0.677, 0.304, 0.908, 0.551, 0.64, 0.603, 0.541, 0.599, 0.606]}










 [{'insert_modules': ('intermediate',), 'bottleneck_dim': (64,), 'non_linearity': 'silu', 'dropout_rate': 0.1, 'normalization': None, 'skip_connection': True}, 0, {'insert_modules': ('attention.self',), 'bottleneck_dim': (32,), 'non_linearity': 'gelu_new', 'dropout_rate': 0.25, 'normalization': 'layer_norm', 'skip_connection': True}, {'insert_modules': ('attention.self', 'attention.output', 'output'), 'bottleneck_dim': (32, 32, 128), 'non_linearity': 'tanh', 'dropout_rate': 0.3, 'normalization': 'layer_norm', 'skip_connection': True}, {'insert_modules': ('output', 'attention.output', 'intermediate'), 'bottleneck_dim': (128, 32, 64), 'non_linearity': 'tanh', 'dropout_rate': 0.1, 'normalization': None, 'skip_connection': True}, {'insert_modules': ('output',), 'bottleneck_dim': (256,), 'non_linearity': 'leakyrelu', 'dropout_rate': 0.2, 'normalization': None, 'skip_connection': True}, {'insert_modules': ('attention.self', 'intermediate'), 'bottleneck_dim': (16, 64), 'non_linearity': 'leakyrelu', 'dropout_rate': 0.3, 'normalization': None, 'skip_connection': True}, 0, {'insert_modules': ('attention.output', 'attention.self', 'intermediate'), 'bottleneck_dim': (64, 32, 128), 'non_linearity': 'gelu_new', 'dropout_rate': 0.3, 'normalization': None, 'skip_connection': True}, {'insert_modules': ('intermediate', 'attention.output', 'attention.self'), 'bottleneck_dim': (128, 64, 16), 'non_linearity': 'tanh', 'dropout_rate': 0.0, 'normalization': None, 'skip_connection': True}, {'insert_modules': ('attention.self',), 'bottleneck_dim': (32,), 'non_linearity': 'gelu_new', 'dropout_rate': 0.0, 'normalization': 'layer_norm', 'skip_connection': True}, {'insert_modules': ('attention.output', 'attention.self', 'intermediate'), 'bottleneck_dim': (32, 16, 64), 'non_linearity': 'swish', 'dropout_rate': 0.3, 'normalization': 'layer_norm', 'skip_connection': True}] 
[INFO|(OpenDelta)basemodel:700]2024-12-30 06:03:01,376 >> Trainable Ratio: 4578672/130508400=3.508335%
[INFO|(OpenDelta)basemodel:702]2024-12-30 06:03:01,376 >> Delta Parameter Ratio: 4578672/130508400=3.508335%
[INFO|(OpenDelta)basemodel:704]2024-12-30 06:03:01,376 >> Static Memory 0.97 GB, Max Memory 16.60 GB
INFO:name:***** Running training for defect detection *****
INFO:name:  Num examples = 21854
INFO:name:  Num Epochs = 15
INFO:name:  Total train batch size  = 32
INFO:name:  Total optimization steps = 10245
Epoch 0 Step 99 Train Loss 0.688   Accuracy 54.625 
Epoch 0 Step 199 Train Loss 0.689   Accuracy 54.219 
Epoch 0 Step 299 Train Loss 0.686   Accuracy 55.115 
Epoch 0 Step 399 Train Loss 0.686   Accuracy 55.195 
Epoch 0 Step 499 Train Loss 0.685   Accuracy 55.381 
Epoch 0 Step 599 Train Loss 0.685   Accuracy 55.505 
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
INFO:name:  eval_loss = 0.7412
INFO:name:  eval_acc = 0.4348
INFO:name:  f1_score = 0.6059
INFO:name:  recall = 1.0
INFO:name:  precision = 0.4346
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.4348
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.4601, 'test_f1_score': 0.6299, 'test_recall': 1.0, 'test_precision': 0.4597}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 1 Step 99 Train Loss 0.688   Accuracy 53.344 
Epoch 1 Step 199 Train Loss 0.685   Accuracy 53.562 
Epoch 1 Step 299 Train Loss 0.685   Accuracy 54.24 
Epoch 1 Step 399 Train Loss 0.685   Accuracy 54.211 
Epoch 1 Step 499 Train Loss 0.683   Accuracy 54.744 
Epoch 1 Step 599 Train Loss 0.683   Accuracy 54.594 
INFO:name:  eval_loss = 0.6625
INFO:name:  eval_acc = 0.5622
INFO:name:  f1_score = 0.5106
INFO:name:  recall = 0.5257
INFO:name:  precision = 0.4964
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.5622
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.5589, 'test_f1_score': 0.5224, 'test_recall': 0.5251, 'test_precision': 0.5197}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 2 Step 99 Train Loss 0.67   Accuracy 58.219 
Epoch 2 Step 199 Train Loss 0.673   Accuracy 57.156 
Epoch 2 Step 299 Train Loss 0.673   Accuracy 57.021 
Epoch 2 Step 399 Train Loss 0.673   Accuracy 57.18 
Epoch 2 Step 499 Train Loss 0.671   Accuracy 57.3 
Epoch 2 Step 599 Train Loss 0.67   Accuracy 57.37 
INFO:name:  eval_loss = 0.6549
INFO:name:  eval_acc = 0.5776
INFO:name:  f1_score = 0.4889
INFO:name:  recall = 0.465
INFO:name:  precision = 0.5154
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.5776
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.5904, 'test_f1_score': 0.512, 'test_recall': 0.4677, 'test_precision': 0.5655}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 3 Step 99 Train Loss 0.654   Accuracy 60.0 
Epoch 3 Step 199 Train Loss 0.653   Accuracy 59.953 
Epoch 3 Step 299 Train Loss 0.652   Accuracy 59.958 
Epoch 3 Step 399 Train Loss 0.651   Accuracy 60.039 
Epoch 3 Step 499 Train Loss 0.651   Accuracy 60.081 
Epoch 3 Step 599 Train Loss 0.651   Accuracy 60.286 
INFO:name:  eval_loss = 0.6317
INFO:name:  eval_acc = 0.6116
INFO:name:  f1_score = 0.5555
INFO:name:  recall = 0.5586
INFO:name:  precision = 0.5525
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6116
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.5977, 'test_f1_score': 0.5415, 'test_recall': 0.5171, 'test_precision': 0.5683}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 4 Step 99 Train Loss 0.634   Accuracy 62.062 
Epoch 4 Step 199 Train Loss 0.633   Accuracy 62.172 
Epoch 4 Step 299 Train Loss 0.634   Accuracy 62.115 
Epoch 4 Step 399 Train Loss 0.634   Accuracy 62.305 
Epoch 4 Step 499 Train Loss 0.636   Accuracy 62.069 
Epoch 4 Step 599 Train Loss 0.633   Accuracy 62.255 
INFO:name:  eval_loss = 0.6528
INFO:name:  eval_acc = 0.5981
INFO:name:  f1_score = 0.6352
INFO:name:  recall = 0.8054
INFO:name:  precision = 0.5244
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 5 Step 99 Train Loss 0.61   Accuracy 65.344 
Epoch 5 Step 199 Train Loss 0.615   Accuracy 64.547 
Epoch 5 Step 299 Train Loss 0.619   Accuracy 63.844 
Epoch 5 Step 399 Train Loss 0.619   Accuracy 63.945 
Epoch 5 Step 499 Train Loss 0.616   Accuracy 64.169 
Epoch 5 Step 599 Train Loss 0.616   Accuracy 64.328 
INFO:name:  eval_loss = 0.6323
INFO:name:  eval_acc = 0.6318
INFO:name:  f1_score = 0.6166
INFO:name:  recall = 0.6816
INFO:name:  precision = 0.563
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6318
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6109, 'test_f1_score': 0.5987, 'test_recall': 0.6319, 'test_precision': 0.5689}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 6 Step 99 Train Loss 0.583   Accuracy 66.031 
Epoch 6 Step 199 Train Loss 0.588   Accuracy 66.016 
Epoch 6 Step 299 Train Loss 0.587   Accuracy 66.333 
Epoch 6 Step 399 Train Loss 0.588   Accuracy 66.461 
Epoch 6 Step 499 Train Loss 0.588   Accuracy 66.394 
Epoch 6 Step 599 Train Loss 0.59   Accuracy 66.141 
INFO:name:  eval_loss = 0.6354
INFO:name:  eval_acc = 0.6391
INFO:name:  f1_score = 0.5868
INFO:name:  recall = 0.5897
INFO:name:  precision = 0.5838
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6391
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.612, 'test_f1_score': 0.567, 'test_recall': 0.553, 'test_precision': 0.5817}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 7 Step 99 Train Loss 0.574   Accuracy 67.156 
Epoch 7 Step 199 Train Loss 0.575   Accuracy 67.578 
Epoch 7 Step 299 Train Loss 0.567   Accuracy 68.271 
Epoch 7 Step 399 Train Loss 0.567   Accuracy 68.352 
Epoch 7 Step 499 Train Loss 0.567   Accuracy 68.481 
Epoch 7 Step 599 Train Loss 0.569   Accuracy 68.266 
INFO:name:  eval_loss = 0.6307
INFO:name:  eval_acc = 0.6453
INFO:name:  f1_score = 0.6122
INFO:name:  recall = 0.6445
INFO:name:  precision = 0.5831
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6453
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6245, 'test_f1_score': 0.6045, 'test_recall': 0.6247, 'test_precision': 0.5855}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 8 Step 99 Train Loss 0.536   Accuracy 70.25 
Epoch 8 Step 199 Train Loss 0.539   Accuracy 70.516 
Epoch 8 Step 299 Train Loss 0.54   Accuracy 70.604 
Epoch 8 Step 399 Train Loss 0.541   Accuracy 70.477 
Epoch 8 Step 499 Train Loss 0.544   Accuracy 70.162 
Epoch 8 Step 599 Train Loss 0.543   Accuracy 70.234 
INFO:name:  eval_loss = 0.6553
INFO:name:  eval_acc = 0.6395
INFO:name:  f1_score = 0.6401
INFO:name:  recall = 0.738
INFO:name:  precision = 0.5652
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 9 Step 99 Train Loss 0.5   Accuracy 72.844 
Epoch 9 Step 199 Train Loss 0.503   Accuracy 72.453 
Epoch 9 Step 299 Train Loss 0.508   Accuracy 72.625 
Epoch 9 Step 399 Train Loss 0.509   Accuracy 72.531 
Epoch 9 Step 499 Train Loss 0.511   Accuracy 72.531 
Epoch 9 Step 599 Train Loss 0.514   Accuracy 72.25 
INFO:name:  eval_loss = 0.6587
INFO:name:  eval_acc = 0.6541
INFO:name:  f1_score = 0.5932
INFO:name:  recall = 0.5805
INFO:name:  precision = 0.6065
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6541
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6325, 'test_f1_score': 0.5855, 'test_recall': 0.5649, 'test_precision': 0.6075}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 10 Step 99 Train Loss 0.495   Accuracy 73.875 
Epoch 10 Step 199 Train Loss 0.51   Accuracy 72.938 
Epoch 10 Step 299 Train Loss 0.506   Accuracy 72.896 
Epoch 10 Step 399 Train Loss 0.503   Accuracy 73.25 
Epoch 10 Step 499 Train Loss 0.504   Accuracy 73.088 
Epoch 10 Step 599 Train Loss 0.503   Accuracy 72.995 
INFO:name:  eval_loss = 0.6745
INFO:name:  eval_acc = 0.649
INFO:name:  f1_score = 0.5986
INFO:name:  recall = 0.6024
INFO:name:  precision = 0.5948
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 11 Step 99 Train Loss 0.475   Accuracy 75.375 
Epoch 11 Step 199 Train Loss 0.473   Accuracy 75.297 
Epoch 11 Step 299 Train Loss 0.476   Accuracy 74.875 
Epoch 11 Step 399 Train Loss 0.479   Accuracy 74.688 
Epoch 11 Step 499 Train Loss 0.479   Accuracy 74.731 
Epoch 11 Step 599 Train Loss 0.479   Accuracy 74.677 
INFO:name:  eval_loss = 0.6406
INFO:name:  eval_acc = 0.6523
INFO:name:  f1_score = 0.6061
INFO:name:  recall = 0.6158
INFO:name:  precision = 0.5967
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 12 Step 99 Train Loss 0.461   Accuracy 76.188 
Epoch 12 Step 199 Train Loss 0.461   Accuracy 75.953 
Epoch 12 Step 299 Train Loss 0.463   Accuracy 75.948 
Epoch 12 Step 399 Train Loss 0.464   Accuracy 75.93 
Epoch 12 Step 499 Train Loss 0.463   Accuracy 76.006 
Epoch 12 Step 599 Train Loss 0.463   Accuracy 75.891 
INFO:name:  eval_loss = 0.6839
INFO:name:  eval_acc = 0.6578
INFO:name:  f1_score = 0.5982
INFO:name:  recall = 0.5864
INFO:name:  precision = 0.6105
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6578
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.627, 'test_f1_score': 0.5846, 'test_recall': 0.5713, 'test_precision': 0.5985}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 13 Step 99 Train Loss 0.454   Accuracy 77.25 
Epoch 13 Step 199 Train Loss 0.45   Accuracy 77.359 
Epoch 13 Step 299 Train Loss 0.453   Accuracy 76.885 
Epoch 13 Step 399 Train Loss 0.452   Accuracy 76.852 
Epoch 13 Step 499 Train Loss 0.451   Accuracy 76.781 
Epoch 13 Step 599 Train Loss 0.452   Accuracy 76.703 
INFO:name:  eval_loss = 0.6913
INFO:name:  eval_acc = 0.6548
INFO:name:  f1_score = 0.6026
INFO:name:  recall = 0.6024
INFO:name:  precision = 0.6029
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 14 Step 99 Train Loss 0.44   Accuracy 77.219 
Epoch 14 Step 199 Train Loss 0.438   Accuracy 77.328 
Epoch 14 Step 299 Train Loss 0.439   Accuracy 77.615 
Epoch 14 Step 399 Train Loss 0.44   Accuracy 77.469 
Epoch 14 Step 499 Train Loss 0.441   Accuracy 77.412 
Epoch 14 Step 599 Train Loss 0.441   Accuracy 77.307 
INFO:name:  eval_loss = 0.7201
INFO:name:  eval_acc = 0.6526
INFO:name:  f1_score = 0.6038
INFO:name:  recall = 0.6091
INFO:name:  precision = 0.5985
INFO:name:Saving model checkpoint to ./models/final_model_defect/model.bin
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6303, 'test_f1_score': 0.5992, 'test_recall': 0.6016, 'test_precision': 0.5968}


train results {'train_loss': [0.685, 0.683, 0.67, 0.65, 0.633, 0.614, 0.591, 0.568, 0.541, 0.515, 0.502, 0.481, 0.465, 0.451, 0.441], 'train_acc': [55.165, 54.498, 57.541, 60.198, 62.308, 64.397, 66.133, 68.317, 70.243, 72.115, 73.076, 74.467, 75.639, 76.737, 77.328], 'eval_loss': [0.741, 0.662, 0.655, 0.632, 0.653, 0.632, 0.635, 0.631, 0.655, 0.659, 0.674, 0.641, 0.684, 0.691, 0.72], 'eval_acc': [0.435, 0.562, 0.578, 0.612, 0.598, 0.632, 0.639, 0.645, 0.64, 0.654, 0.649, 0.652, 0.658, 0.655, 0.653], 'eval_f1': [0.606, 0.511, 0.489, 0.556, 0.635, 0.617, 0.587, 0.612, 0.64, 0.593, 0.599, 0.606, 0.598, 0.603, 0.604], 'eval_precision': [0.435, 0.496, 0.515, 0.552, 0.524, 0.563, 0.584, 0.583, 0.565, 0.606, 0.595, 0.597, 0.61, 0.603, 0.598], 'eval_recall': [1.0, 0.526, 0.465, 0.559, 0.805, 0.682, 0.59, 0.644, 0.738, 0.58, 0.602, 0.616, 0.586, 0.602, 0.609]}









[INFO|(OpenDelta)basemodel:700]2024-12-30 07:54:26,693 >> Trainable Ratio: 4578672/130508400=3.508335%
[INFO|(OpenDelta)basemodel:702]2024-12-30 07:54:26,694 >> Delta Parameter Ratio: 4578672/130508400=3.508335%
[INFO|(OpenDelta)basemodel:704]2024-12-30 07:54:26,694 >> Static Memory 1.46 GB, Max Memory 18.28 GB

 [{'insert_modules': ('attention.self',), 'bottleneck_dim': (32,), 'non_linearity': 'gelu_new', 'dropout_rate': 0.25, 'normalization': 'layer_norm', 'skip_connection': True}, 0, {'insert_modules': ('intermediate',), 'bottleneck_dim': (64,), 'non_linearity': 'silu', 'dropout_rate': 0.1, 'normalization': None, 'skip_connection': True}, {'insert_modules': ('attention.self', 'attention.output', 'output'), 'bottleneck_dim': (32, 32, 128), 'non_linearity': 'tanh', 'dropout_rate': 0.3, 'normalization': 'layer_norm', 'skip_connection': True}, {'insert_modules': ('output', 'attention.output', 'intermediate'), 'bottleneck_dim': (128, 32, 64), 'non_linearity': 'tanh', 'dropout_rate': 0.1, 'normalization': None, 'skip_connection': True}, {'insert_modules': ('output',), 'bottleneck_dim': (256,), 'non_linearity': 'leakyrelu', 'dropout_rate': 0.2, 'normalization': None, 'skip_connection': True}, {'insert_modules': ('attention.self', 'intermediate'), 'bottleneck_dim': (16, 64), 'non_linearity': 'leakyrelu', 'dropout_rate': 0.3, 'normalization': None, 'skip_connection': True}, {'insert_modules': ('intermediate', 'attention.output', 'attention.self'), 'bottleneck_dim': (128, 64, 16), 'non_linearity': 'tanh', 'dropout_rate': 0.0, 'normalization': None, 'skip_connection': True}, {'insert_modules': ('attention.output', 'attention.self', 'intermediate'), 'bottleneck_dim': (64, 32, 128), 'non_linearity': 'gelu_new', 'dropout_rate': 0.3, 'normalization': None, 'skip_connection': True}, 0, {'insert_modules': ('attention.self',), 'bottleneck_dim': (32,), 'non_linearity': 'gelu_new', 'dropout_rate': 0.0, 'normalization': 'layer_norm', 'skip_connection': True}, {'insert_modules': ('attention.output', 'attention.self', 'intermediate'), 'bottleneck_dim': (32, 16, 64), 'non_linearity': 'swish', 'dropout_rate': 0.3, 'normalization': 'layer_norm', 'skip_connection': True}] 
INFO:name:***** Running training for defect detection *****
INFO:name:  Num examples = 21854
INFO:name:  Num Epochs = 15
INFO:name:  Total train batch size  = 32
INFO:name:  Total optimization steps = 10245
INFO:name:
Epoch 0 Step 99 Train Loss 0.692   Accuracy 51.281 
Epoch 0 Step 199 Train Loss 0.69   Accuracy 52.797 
Epoch 0 Step 299 Train Loss 0.688   Accuracy 53.75 
Epoch 0 Step 399 Train Loss 0.687   Accuracy 54.289 
Epoch 0 Step 499 Train Loss 0.686   Accuracy 54.7 
Epoch 0 Step 599 Train Loss 0.684   Accuracy 54.974 
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
INFO:name:  eval_loss = 0.6581
INFO:name:  eval_acc = 0.5878
INFO:name:  f1_score = 0.3731
INFO:name:  recall = 0.2822
INFO:name:  precision = 0.5501
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.5878
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.5695, 'test_f1_score': 0.3677, 'test_recall': 0.2725, 'test_precision': 0.5653}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 1 Step 99 Train Loss 0.67   Accuracy 56.969 
Epoch 1 Step 199 Train Loss 0.669   Accuracy 57.391 
Epoch 1 Step 299 Train Loss 0.669   Accuracy 57.708 
Epoch 1 Step 399 Train Loss 0.666   Accuracy 57.781 
Epoch 1 Step 499 Train Loss 0.668   Accuracy 57.569 
Epoch 1 Step 599 Train Loss 0.67   Accuracy 57.089 
INFO:name:  eval_loss = 0.689
INFO:name:  eval_acc = 0.5655
INFO:name:  f1_score = 0.0
INFO:name:  recall = 0.0
INFO:name:  precision = 0.0
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 2 Step 99 Train Loss 0.693   Accuracy 52.5 
Epoch 2 Step 199 Train Loss 0.692   Accuracy 53.406 
Epoch 2 Step 299 Train Loss 0.691   Accuracy 53.698 
Epoch 2 Step 399 Train Loss 0.691   Accuracy 53.508 
Epoch 2 Step 499 Train Loss 0.691   Accuracy 53.506 
Epoch 2 Step 599 Train Loss 0.691   Accuracy 53.844 
INFO:name:  eval_loss = 0.6844
INFO:name:  eval_acc = 0.5655
INFO:name:  f1_score = 0.0
INFO:name:  recall = 0.0
INFO:name:  precision = 0.0
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 3 Step 99 Train Loss 0.692   Accuracy 53.406 
Epoch 3 Step 199 Train Loss 0.691   Accuracy 54.016 
Epoch 3 Step 299 Train Loss 0.69   Accuracy 54.229 
Epoch 3 Step 399 Train Loss 0.69   Accuracy 54.156 
Epoch 3 Step 499 Train Loss 0.69   Accuracy 54.025 
Epoch 3 Step 599 Train Loss 0.69   Accuracy 54.141 
INFO:name:  eval_loss = 0.688
INFO:name:  eval_acc = 0.5655
INFO:name:  f1_score = 0.0
INFO:name:  recall = 0.0
INFO:name:  precision = 0.0
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 4 Step 99 Train Loss 0.689   Accuracy 55.281 
Epoch 4 Step 199 Train Loss 0.691   Accuracy 54.078 
Epoch 4 Step 299 Train Loss 0.69   Accuracy 54.271 
Epoch 4 Step 399 Train Loss 0.69   Accuracy 54.148 
Epoch 4 Step 499 Train Loss 0.69   Accuracy 54.281 
Epoch 4 Step 599 Train Loss 0.69   Accuracy 54.089 
INFO:name:  eval_loss = 0.685
INFO:name:  eval_acc = 0.5655
INFO:name:  f1_score = 0.0
INFO:name:  recall = 0.0
INFO:name:  precision = 0.0
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 5 Step 99 Train Loss 0.691   Accuracy 53.469 
Epoch 5 Step 199 Train Loss 0.69   Accuracy 54.125 
Epoch 5 Step 299 Train Loss 0.69   Accuracy 54.302 
Epoch 5 Step 399 Train Loss 0.69   Accuracy 54.203 
Epoch 5 Step 499 Train Loss 0.69   Accuracy 54.338 
Epoch 5 Step 599 Train Loss 0.69   Accuracy 54.276 
INFO:name:  eval_loss = 0.6872
INFO:name:  eval_acc = 0.5655
INFO:name:  f1_score = 0.0
INFO:name:  recall = 0.0
INFO:name:  precision = 0.0
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 6 Step 99 Train Loss 0.689   Accuracy 54.812 
Epoch 6 Step 199 Train Loss 0.689   Accuracy 54.859 
Epoch 6 Step 299 Train Loss 0.69   Accuracy 54.167 
Epoch 6 Step 399 Train Loss 0.69   Accuracy 54.398 
Epoch 6 Step 499 Train Loss 0.69   Accuracy 54.138 
Epoch 6 Step 599 Train Loss 0.69   Accuracy 54.115 
INFO:name:  eval_loss = 0.6853
INFO:name:  eval_acc = 0.5655
INFO:name:  f1_score = 0.0
INFO:name:  recall = 0.0
INFO:name:  precision = 0.0
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 7 Step 99 Train Loss 0.692   Accuracy 53.438 
Epoch 7 Step 199 Train Loss 0.691   Accuracy 53.609 
Epoch 7 Step 299 Train Loss 0.691   Accuracy 53.896 
Epoch 7 Step 399 Train Loss 0.69   Accuracy 53.875 
Epoch 7 Step 499 Train Loss 0.69   Accuracy 53.956 
Epoch 7 Step 599 Train Loss 0.69   Accuracy 54.078 
INFO:name:  eval_loss = 0.6847
INFO:name:  eval_acc = 0.5655
INFO:name:  f1_score = 0.0
INFO:name:  recall = 0.0
INFO:name:  precision = 0.0
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 8 Step 99 Train Loss 0.689   Accuracy 54.438 
Epoch 8 Step 199 Train Loss 0.69   Accuracy 54.25 
Epoch 8 Step 299 Train Loss 0.69   Accuracy 54.094 
Epoch 8 Step 399 Train Loss 0.69   Accuracy 54.062 
Epoch 8 Step 499 Train Loss 0.69   Accuracy 54.325 
Epoch 8 Step 599 Train Loss 0.69   Accuracy 54.115 
INFO:name:  eval_loss = 0.685
INFO:name:  eval_acc = 0.5655
INFO:name:  f1_score = 0.0
INFO:name:  recall = 0.0
INFO:name:  precision = 0.0
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 9 Step 99 Train Loss 0.689   Accuracy 54.812 
Epoch 9 Step 199 Train Loss 0.689   Accuracy 54.641 
Epoch 9 Step 299 Train Loss 0.689   Accuracy 54.667 
Epoch 9 Step 399 Train Loss 0.69   Accuracy 54.359 
Epoch 9 Step 499 Train Loss 0.69   Accuracy 54.1 
Epoch 9 Step 599 Train Loss 0.69   Accuracy 54.266 
INFO:name:  eval_loss = 0.6858
INFO:name:  eval_acc = 0.5655
INFO:name:  f1_score = 0.0
INFO:name:  recall = 0.0
INFO:name:  precision = 0.0
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 10 Step 99 Train Loss 0.69   Accuracy 53.938 
Epoch 10 Step 199 Train Loss 0.69   Accuracy 53.766 
Epoch 10 Step 299 Train Loss 0.691   Accuracy 53.75 
Epoch 10 Step 399 Train Loss 0.69   Accuracy 54.086 
Epoch 10 Step 499 Train Loss 0.69   Accuracy 54.031 
Epoch 10 Step 599 Train Loss 0.69   Accuracy 54.12 
INFO:name:  eval_loss = 0.6851
INFO:name:  eval_acc = 0.5655
INFO:name:  f1_score = 0.0
INFO:name:  recall = 0.0
INFO:name:  precision = 0.0
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 11 Step 99 Train Loss 0.69   Accuracy 54.219 
Epoch 11 Step 199 Train Loss 0.69   Accuracy 54.375 
Epoch 11 Step 299 Train Loss 0.69   Accuracy 54.208 
Epoch 11 Step 399 Train Loss 0.69   Accuracy 54.211 
Epoch 11 Step 499 Train Loss 0.69   Accuracy 54.238 
Epoch 11 Step 599 Train Loss 0.69   Accuracy 54.198 
INFO:name:  eval_loss = 0.6855
INFO:name:  eval_acc = 0.5655
INFO:name:  f1_score = 0.0
INFO:name:  recall = 0.0
INFO:name:  precision = 0.0
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 12 Step 99 Train Loss 0.692   Accuracy 52.656 
Epoch 12 Step 199 Train Loss 0.69   Accuracy 53.891 
Epoch 12 Step 299 Train Loss 0.69   Accuracy 53.917 
Epoch 12 Step 399 Train Loss 0.69   Accuracy 54.367 
Epoch 12 Step 499 Train Loss 0.69   Accuracy 54.244 
Epoch 12 Step 599 Train Loss 0.69   Accuracy 53.917 
INFO:name:  eval_loss = 0.6851
INFO:name:  eval_acc = 0.5655
INFO:name:  f1_score = 0.0
INFO:name:  recall = 0.0
INFO:name:  precision = 0.0
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 13 Step 99 Train Loss 0.69   Accuracy 53.688 
Epoch 13 Step 199 Train Loss 0.689   Accuracy 54.422 
Epoch 13 Step 299 Train Loss 0.689   Accuracy 54.615 
Epoch 13 Step 399 Train Loss 0.689   Accuracy 54.469 
Epoch 13 Step 499 Train Loss 0.689   Accuracy 54.512 
Epoch 13 Step 599 Train Loss 0.689   Accuracy 54.484 
INFO:name:  eval_loss = 0.6856
INFO:name:  eval_acc = 0.5655
INFO:name:  f1_score = 0.0
INFO:name:  recall = 0.0
INFO:name:  precision = 0.0
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 14 Step 99 Train Loss 0.691   Accuracy 53.25 
Epoch 14 Step 199 Train Loss 0.691   Accuracy 53.594 
Epoch 14 Step 299 Train Loss 0.691   Accuracy 53.625 
Epoch 14 Step 399 Train Loss 0.69   Accuracy 54.086 
Epoch 14 Step 499 Train Loss 0.69   Accuracy 54.25 
Epoch 14 Step 599 Train Loss 0.69   Accuracy 54.021 
INFO:name:  eval_loss = 0.6855
INFO:name:  eval_acc = 0.5655
INFO:name:  f1_score = 0.0
INFO:name:  recall = 0.0
INFO:name:  precision = 0.0
INFO:name:Saving model checkpoint to ./models/final_model_defect/model.bin
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.5406, 'test_f1_score': 0.0, 'test_recall': 0.0, 'test_precision': 0.0}
[INFO|(OpenDelta)basemodel:700]2024-12-30 09:43:46,142 >> Trainable Ratio: 1957936/127887664=1.530981%
[INFO|(OpenDelta)basemodel:702]2024-12-30 09:43:46,142 >> Delta Parameter Ratio: 1957936/127887664=1.530981%
[INFO|(OpenDelta)basemodel:704]2024-12-30 09:43:46,142 >> Static Memory 0.51 GB, Max Memory 19.02 GB
INFO:name:***** Running training for defect detection *****
INFO:name:  Num examples = 21854
INFO:name:  Num Epochs = 15
INFO:name:  Total train batch size  = 32
INFO:name:  Total optimization steps = 10245
train results {'train_loss': [0.684, 0.673, 0.69, 0.69, 0.69, 0.69, 0.69, 0.69, 0.69, 0.69, 0.69, 0.69, 0.69, 0.69, 0.69], 'train_acc': [55.057, 56.442, 53.922, 54.145, 54.122, 54.168, 54.147, 54.173, 54.15, 54.155, 54.163, 54.16, 54.158, 54.154, 54.159], 'eval_loss': [0.658, 0.689, 0.684, 0.688, 0.685, 0.687, 0.685, 0.685, 0.685, 0.686, 0.685, 0.685, 0.685, 0.686, 0.685], 'eval_acc': [0.588, 0.566, 0.566, 0.566, 0.566, 0.566, 0.566, 0.566, 0.566, 0.566, 0.566, 0.566, 0.566, 0.566, 0.566], 'eval_f1': [0.373, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'eval_precision': [0.55, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'eval_recall': [0.282, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}













 [{'insert_modules': ('attention.self', 'intermediate', 'output'), 'bottleneck_dim': (16, 64, 128), 'non_linearity': 'gelu', 'dropout_rate': 0.2, 'normalization': 'layer_norm', 'skip_connection': True}, 0, 0, {'insert_modules': ('intermediate', 'attention.self'), 'bottleneck_dim': (64, 32), 'non_linearity': 'swish', 'dropout_rate': 0.3, 'normalization': 'layer_norm', 'skip_connection': True}, 0, 0, 0, 0, 0, 0, {'insert_modules': ('attention.output', 'intermediate', 'attention.self'), 'bottleneck_dim': (32, 64, 16), 'non_linearity': 'silu', 'dropout_rate': 0.0, 'normalization': None, 'skip_connection': True}, {'insert_modules': ('output', 'attention.self'), 'bottleneck_dim': (256, 16), 'non_linearity': 'leakyrelu', 'dropout_rate': 0.1, 'normalization': 'layer_norm', 'skip_connection': True}] 

INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 0 Step 99 Train Loss 0.695   Accuracy 50.125 
Epoch 0 Step 199 Train Loss 0.692   Accuracy 52.141 
Epoch 0 Step 299 Train Loss 0.688   Accuracy 53.75 
Epoch 0 Step 399 Train Loss 0.687   Accuracy 54.5 
Epoch 0 Step 499 Train Loss 0.685   Accuracy 54.925 
Epoch 0 Step 599 Train Loss 0.683   Accuracy 55.328 
INFO:name:  eval_loss = 0.6704
INFO:name:  eval_acc = 0.5714
INFO:name:  f1_score = 0.1149
INFO:name:  recall = 0.064
INFO:name:  precision = 0.5588
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.5714
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.549, 'test_f1_score': 0.106, 'test_recall': 0.0582, 'test_precision': 0.5935}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 1 Step 99 Train Loss 0.676   Accuracy 56.75 
Epoch 1 Step 199 Train Loss 0.678   Accuracy 56.188 
Epoch 1 Step 299 Train Loss 0.676   Accuracy 56.865 
Epoch 1 Step 399 Train Loss 0.675   Accuracy 57.156 
Epoch 1 Step 499 Train Loss 0.673   Accuracy 57.544 
Epoch 1 Step 599 Train Loss 0.672   Accuracy 57.682 
INFO:name:  eval_loss = 0.6461
INFO:name:  eval_acc = 0.6032
INFO:name:  f1_score = 0.5009
INFO:name:  recall = 0.4583
INFO:name:  precision = 0.5523
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6032
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.5944, 'test_f1_score': 0.4964, 'test_recall': 0.4351, 'test_precision': 0.5778}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 2 Step 99 Train Loss 0.65   Accuracy 60.219 
Epoch 2 Step 199 Train Loss 0.65   Accuracy 60.688 
Epoch 2 Step 299 Train Loss 0.651   Accuracy 60.469 
Epoch 2 Step 399 Train Loss 0.648   Accuracy 60.82 
Epoch 2 Step 499 Train Loss 0.647   Accuracy 60.744 
Epoch 2 Step 599 Train Loss 0.644   Accuracy 61.036 
INFO:name:  eval_loss = 0.6236
INFO:name:  eval_acc = 0.6274
INFO:name:  f1_score = 0.536
INFO:name:  recall = 0.4954
INFO:name:  precision = 0.5839
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6274
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6142, 'test_f1_score': 0.534, 'test_recall': 0.4813, 'test_precision': 0.5998}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 3 Step 99 Train Loss 0.617   Accuracy 64.781 
Epoch 3 Step 199 Train Loss 0.616   Accuracy 64.406 
Epoch 3 Step 299 Train Loss 0.618   Accuracy 63.979 
Epoch 3 Step 399 Train Loss 0.619   Accuracy 63.578 
Epoch 3 Step 499 Train Loss 0.621   Accuracy 63.4 
Epoch 3 Step 599 Train Loss 0.622   Accuracy 63.271 
INFO:name:  eval_loss = 0.6421
INFO:name:  eval_acc = 0.6299
INFO:name:  f1_score = 0.4844
INFO:name:  recall = 0.4002
INFO:name:  precision = 0.6137
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6299
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6094, 'test_f1_score': 0.4668, 'test_recall': 0.3721, 'test_precision': 0.626}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 4 Step 99 Train Loss 0.588   Accuracy 66.656 
Epoch 4 Step 199 Train Loss 0.595   Accuracy 65.891 
Epoch 4 Step 299 Train Loss 0.597   Accuracy 65.917 
Epoch 4 Step 399 Train Loss 0.598   Accuracy 66.094 
Epoch 4 Step 499 Train Loss 0.597   Accuracy 66.0 
Epoch 4 Step 599 Train Loss 0.595   Accuracy 66.13 
INFO:name:  eval_loss = 0.6174
INFO:name:  eval_acc = 0.6387
INFO:name:  f1_score = 0.592
INFO:name:  recall = 0.6032
INFO:name:  precision = 0.5812
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6387
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.619, 'test_f1_score': 0.5804, 'test_recall': 0.5737, 'test_precision': 0.5873}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 5 Step 99 Train Loss 0.568   Accuracy 69.219 
Epoch 5 Step 199 Train Loss 0.576   Accuracy 68.453 
Epoch 5 Step 299 Train Loss 0.572   Accuracy 68.635 
Epoch 5 Step 399 Train Loss 0.572   Accuracy 68.5 
Epoch 5 Step 499 Train Loss 0.572   Accuracy 68.131 
Epoch 5 Step 599 Train Loss 0.57   Accuracy 68.38 
INFO:name:  eval_loss = 0.6115
INFO:name:  eval_acc = 0.6515
INFO:name:  f1_score = 0.4809
INFO:name:  recall = 0.3715
INFO:name:  precision = 0.6816
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6515
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6292, 'test_f1_score': 0.4694, 'test_recall': 0.357, 'test_precision': 0.685}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 6 Step 99 Train Loss 0.547   Accuracy 69.781 
Epoch 6 Step 199 Train Loss 0.545   Accuracy 70.0 
Epoch 6 Step 299 Train Loss 0.548   Accuracy 69.208 
Epoch 6 Step 399 Train Loss 0.542   Accuracy 69.703 
Epoch 6 Step 499 Train Loss 0.543   Accuracy 69.906 
Epoch 6 Step 599 Train Loss 0.544   Accuracy 69.828 
INFO:name:  eval_loss = 0.5971
INFO:name:  eval_acc = 0.6508
INFO:name:  f1_score = 0.6103
INFO:name:  recall = 0.6293
INFO:name:  precision = 0.5924
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 7 Step 99 Train Loss 0.508   Accuracy 72.188 
Epoch 7 Step 199 Train Loss 0.517   Accuracy 71.688 
Epoch 7 Step 299 Train Loss 0.519   Accuracy 71.833 
Epoch 7 Step 399 Train Loss 0.518   Accuracy 72.0 
Epoch 7 Step 499 Train Loss 0.517   Accuracy 72.269 
Epoch 7 Step 599 Train Loss 0.518   Accuracy 72.266 
INFO:name:  eval_loss = 0.6204
INFO:name:  eval_acc = 0.6673
INFO:name:  f1_score = 0.5511
INFO:name:  recall = 0.4701
INFO:name:  precision = 0.6659
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6673
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6358, 'test_f1_score': 0.5223, 'test_recall': 0.4335, 'test_precision': 0.657}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 8 Step 99 Train Loss 0.495   Accuracy 73.219 
Epoch 8 Step 199 Train Loss 0.488   Accuracy 74.156 
Epoch 8 Step 299 Train Loss 0.487   Accuracy 74.292 
Epoch 8 Step 399 Train Loss 0.495   Accuracy 73.742 
Epoch 8 Step 499 Train Loss 0.511   Accuracy 72.5 
Epoch 8 Step 599 Train Loss 0.519   Accuracy 71.812 
INFO:name:  eval_loss = 0.5949
INFO:name:  eval_acc = 0.6611
INFO:name:  f1_score = 0.5309
INFO:name:  recall = 0.4414
INFO:name:  precision = 0.6658
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 9 Step 99 Train Loss 0.504   Accuracy 73.594 
Epoch 9 Step 199 Train Loss 0.497   Accuracy 73.797 
Epoch 9 Step 299 Train Loss 0.5   Accuracy 73.417 
Epoch 9 Step 399 Train Loss 0.5   Accuracy 73.383 
Epoch 9 Step 499 Train Loss 0.5   Accuracy 73.325 
Epoch 9 Step 599 Train Loss 0.504   Accuracy 73.172 
INFO:name:  eval_loss = 0.6182
INFO:name:  eval_acc = 0.6519
INFO:name:  f1_score = 0.5667
INFO:name:  recall = 0.524
INFO:name:  precision = 0.6171
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 10 Step 99 Train Loss 0.484   Accuracy 74.188 
Epoch 10 Step 199 Train Loss 0.484   Accuracy 74.203 
Epoch 10 Step 299 Train Loss 0.486   Accuracy 74.01 
Epoch 10 Step 399 Train Loss 0.485   Accuracy 74.133 
Epoch 10 Step 499 Train Loss 0.487   Accuracy 73.938 
Epoch 10 Step 599 Train Loss 0.485   Accuracy 74.151 
INFO:name:  eval_loss = 0.659
INFO:name:  eval_acc = 0.6654
INFO:name:  f1_score = 0.5269
INFO:name:  recall = 0.4288
INFO:name:  precision = 0.6832
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 11 Step 99 Train Loss 0.461   Accuracy 76.188 
Epoch 11 Step 199 Train Loss 0.463   Accuracy 76.031 
Epoch 11 Step 299 Train Loss 0.471   Accuracy 75.292 
Epoch 11 Step 399 Train Loss 0.471   Accuracy 75.484 
Epoch 11 Step 499 Train Loss 0.471   Accuracy 75.481 
Epoch 11 Step 599 Train Loss 0.469   Accuracy 75.536 
INFO:name:  eval_loss = 0.6413
INFO:name:  eval_acc = 0.6673
INFO:name:  f1_score = 0.6018
INFO:name:  recall = 0.5788
INFO:name:  precision = 0.6268
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 12 Step 99 Train Loss 0.444   Accuracy 77.375 
Epoch 12 Step 199 Train Loss 0.447   Accuracy 77.188 
Epoch 12 Step 299 Train Loss 0.45   Accuracy 76.76 
Epoch 12 Step 399 Train Loss 0.45   Accuracy 76.812 
Epoch 12 Step 499 Train Loss 0.446   Accuracy 77.025 
Epoch 12 Step 599 Train Loss 0.448   Accuracy 76.75 
INFO:name:  eval_loss = 0.6658
INFO:name:  eval_acc = 0.6552
INFO:name:  f1_score = 0.5971
INFO:name:  recall = 0.588
INFO:name:  precision = 0.6064
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 13 Step 99 Train Loss 0.417   Accuracy 79.406 
Epoch 13 Step 199 Train Loss 0.433   Accuracy 78.141 
Epoch 13 Step 299 Train Loss 0.43   Accuracy 78.167 
Epoch 13 Step 399 Train Loss 0.432   Accuracy 77.914 
Epoch 13 Step 499 Train Loss 0.433   Accuracy 77.625 
Epoch 13 Step 599 Train Loss 0.434   Accuracy 77.531 
INFO:name:  eval_loss = 0.6735
INFO:name:  eval_acc = 0.6647
INFO:name:  f1_score = 0.5961
INFO:name:  recall = 0.5695
INFO:name:  precision = 0.6253
INFO:name:Saving model checkpoint to ./models/final_model_defect/model.bin
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6266, 'test_f1_score': 0.5689, 'test_recall': 0.5363, 'test_precision': 0.6058}
[INFO|(OpenDelta)basemodel:700]2024-12-30 11:23:09,794 >> Trainable Ratio: 1313904/127243632=1.032589%
[INFO|(OpenDelta)basemodel:702]2024-12-30 11:23:09,794 >> Delta Parameter Ratio: 1313904/127243632=1.032589%
[INFO|(OpenDelta)basemodel:704]2024-12-30 11:23:09,794 >> Static Memory 0.99 GB, Max Memory 19.02 GB
INFO:name:***** Running training for defect detection *****
INFO:name:  Num examples = 21854
INFO:name:  Num Epochs = 15
INFO:name:  Total train batch size  = 32
INFO:name:  Total optimization steps = 10245
train results {'train_loss': [0.684, 0.672, 0.643, 0.621, 0.595, 0.569, 0.543, 0.517, 0.522, 0.506, 0.486, 0.47, 0.449, 0.434], 'train_acc': [55.363, 57.687, 61.111, 63.435, 66.166, 68.339, 69.96, 72.267, 71.473, 73.095, 74.1, 75.548, 76.654, 77.712], 'eval_loss': [0.67, 0.646, 0.624, 0.642, 0.617, 0.612, 0.597, 0.62, 0.595, 0.618, 0.659, 0.641, 0.666, 0.673], 'eval_acc': [0.571, 0.603, 0.627, 0.63, 0.639, 0.652, 0.651, 0.667, 0.661, 0.652, 0.665, 0.667, 0.655, 0.665], 'eval_f1': [0.115, 0.501, 0.536, 0.484, 0.592, 0.481, 0.61, 0.551, 0.531, 0.567, 0.527, 0.602, 0.597, 0.596], 'eval_precision': [0.559, 0.552, 0.584, 0.614, 0.581, 0.682, 0.592, 0.666, 0.666, 0.617, 0.683, 0.627, 0.606, 0.625], 'eval_recall': [0.064, 0.458, 0.495, 0.4, 0.603, 0.372, 0.629, 0.47, 0.441, 0.524, 0.429, 0.579, 0.588, 0.57]}









 [{'insert_modules': ('attention.self', 'intermediate', 'output'), 'bottleneck_dim': (16, 64, 128), 'non_linearity': 'gelu', 'dropout_rate': 0.2, 'normalization': 'layer_norm', 'skip_connection': True}, 0, 0, {'insert_modules': ('intermediate', 'attention.self'), 'bottleneck_dim': (64, 32), 'non_linearity': 'swish', 'dropout_rate': 0.3, 'normalization': 'layer_norm', 'skip_connection': True}, 0, 0, 0, 0, 0, 0, {'insert_modules': ('attention.self', 'output'), 'bottleneck_dim': (32, 128), 'non_linearity': 'silu', 'dropout_rate': 0.25, 'normalization': 'layer_norm', 'skip_connection': True}, 0] 

INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 0 Step 99 Train Loss 0.691   Accuracy 53.094 
Epoch 0 Step 199 Train Loss 0.69   Accuracy 53.469 
Epoch 0 Step 299 Train Loss 0.687   Accuracy 54.417 
Epoch 0 Step 399 Train Loss 0.687   Accuracy 54.469 
Epoch 0 Step 499 Train Loss 0.686   Accuracy 54.738 
Epoch 0 Step 599 Train Loss 0.684   Accuracy 55.151 
INFO:name:  eval_loss = 0.6568
INFO:name:  eval_acc = 0.5864
INFO:name:  f1_score = 0.3879
INFO:name:  recall = 0.3016
INFO:name:  precision = 0.5432
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.5864
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.5699, 'test_f1_score': 0.3946, 'test_recall': 0.3052, 'test_precision': 0.5583}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 1 Step 99 Train Loss 0.666   Accuracy 59.062 
Epoch 1 Step 199 Train Loss 0.658   Accuracy 59.516 
Epoch 1 Step 299 Train Loss 0.658   Accuracy 59.417 
Epoch 1 Step 399 Train Loss 0.662   Accuracy 58.57 
Epoch 1 Step 499 Train Loss 0.662   Accuracy 58.462 
Epoch 1 Step 599 Train Loss 0.659   Accuracy 58.844 
INFO:name:  eval_loss = 0.6523
INFO:name:  eval_acc = 0.5809
INFO:name:  f1_score = 0.6138
INFO:name:  recall = 0.7666
INFO:name:  precision = 0.5118
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 2 Step 99 Train Loss 0.653   Accuracy 59.969 
Epoch 2 Step 199 Train Loss 0.64   Accuracy 61.203 
Epoch 2 Step 299 Train Loss 0.638   Accuracy 61.74 
Epoch 2 Step 399 Train Loss 0.635   Accuracy 62.25 
Epoch 2 Step 499 Train Loss 0.633   Accuracy 62.4 
Epoch 2 Step 599 Train Loss 0.633   Accuracy 62.354 
INFO:name:  eval_loss = 0.6242
INFO:name:  eval_acc = 0.6255
INFO:name:  f1_score = 0.4526
INFO:name:  recall = 0.3564
INFO:name:  precision = 0.6202
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6255
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6135, 'test_f1_score': 0.4465, 'test_recall': 0.3394, 'test_precision': 0.6524}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 3 Step 99 Train Loss 0.596   Accuracy 65.719 
Epoch 3 Step 199 Train Loss 0.597   Accuracy 65.234 
Epoch 3 Step 299 Train Loss 0.596   Accuracy 65.24 
Epoch 3 Step 399 Train Loss 0.6   Accuracy 64.82 
Epoch 3 Step 499 Train Loss 0.598   Accuracy 65.231 
Epoch 3 Step 599 Train Loss 0.599   Accuracy 65.062 
INFO:name:  eval_loss = 0.6346
INFO:name:  eval_acc = 0.6347
INFO:name:  f1_score = 0.591
INFO:name:  recall = 0.6074
INFO:name:  precision = 0.5754
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6347
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6457, 'test_f1_score': 0.6137, 'test_recall': 0.6127, 'test_precision': 0.6147}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 4 Step 99 Train Loss 0.554   Accuracy 68.719 
Epoch 4 Step 199 Train Loss 0.563   Accuracy 67.75 
Epoch 4 Step 299 Train Loss 0.564   Accuracy 67.469 
Epoch 4 Step 399 Train Loss 0.57   Accuracy 67.305 
Epoch 4 Step 499 Train Loss 0.574   Accuracy 66.962 
Epoch 4 Step 599 Train Loss 0.577   Accuracy 66.75 
INFO:name:  eval_loss = 0.6239
INFO:name:  eval_acc = 0.6537
INFO:name:  f1_score = 0.5098
INFO:name:  recall = 0.4145
INFO:name:  precision = 0.6622
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6537
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.638, 'test_f1_score': 0.5102, 'test_recall': 0.4104, 'test_precision': 0.6741}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 5 Step 99 Train Loss 0.566   Accuracy 68.438 
Epoch 5 Step 199 Train Loss 0.565   Accuracy 68.328 
Epoch 5 Step 299 Train Loss 0.564   Accuracy 68.469 
Epoch 5 Step 399 Train Loss 0.562   Accuracy 68.602 
Epoch 5 Step 499 Train Loss 0.561   Accuracy 68.569 
Epoch 5 Step 599 Train Loss 0.562   Accuracy 68.661 
INFO:name:  eval_loss = 0.7461
INFO:name:  eval_acc = 0.6051
INFO:name:  f1_score = 0.6456
INFO:name:  recall = 0.8281
INFO:name:  precision = 0.5291
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 6 Step 99 Train Loss 0.549   Accuracy 69.938 
Epoch 6 Step 199 Train Loss 0.549   Accuracy 69.609 
Epoch 6 Step 299 Train Loss 0.551   Accuracy 69.615 
Epoch 6 Step 399 Train Loss 0.551   Accuracy 69.57 
Epoch 6 Step 499 Train Loss 0.547   Accuracy 69.75 
Epoch 6 Step 599 Train Loss 0.545   Accuracy 69.729 
INFO:name:  eval_loss = 0.6237
INFO:name:  eval_acc = 0.6713
INFO:name:  f1_score = 0.5581
INFO:name:  recall = 0.4777
INFO:name:  precision = 0.671
INFO:name:
 ******************************
INFO:name:  Best validation accuracy :0.6713
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6424, 'test_f1_score': 0.542, 'test_recall': 0.4606, 'test_precision': 0.6583}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 7 Step 99 Train Loss 0.517   Accuracy 72.188 
Epoch 7 Step 199 Train Loss 0.512   Accuracy 72.688 
Epoch 7 Step 299 Train Loss 0.52   Accuracy 71.531 
Epoch 7 Step 399 Train Loss 0.521   Accuracy 71.391 
Epoch 7 Step 499 Train Loss 0.522   Accuracy 71.125 
Epoch 7 Step 599 Train Loss 0.523   Accuracy 71.068 
INFO:name:  eval_loss = 0.6352
INFO:name:  eval_acc = 0.6596
INFO:name:  f1_score = 0.5981
INFO:name:  recall = 0.583
INFO:name:  precision = 0.614
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 8 Step 99 Train Loss 0.496   Accuracy 73.625 
Epoch 8 Step 199 Train Loss 0.504   Accuracy 72.984 
Epoch 8 Step 299 Train Loss 0.503   Accuracy 73.01 
Epoch 8 Step 399 Train Loss 0.503   Accuracy 73.094 
Epoch 8 Step 499 Train Loss 0.504   Accuracy 73.038 
Epoch 8 Step 599 Train Loss 0.503   Accuracy 73.026 
INFO:name:  eval_loss = 0.6419
INFO:name:  eval_acc = 0.6519
INFO:name:  f1_score = 0.5896
INFO:name:  recall = 0.5754
INFO:name:  precision = 0.6044
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 9 Step 99 Train Loss 0.474   Accuracy 75.531 
Epoch 9 Step 199 Train Loss 0.472   Accuracy 75.297 
Epoch 9 Step 299 Train Loss 0.48   Accuracy 74.396 
Epoch 9 Step 399 Train Loss 0.48   Accuracy 74.492 
Epoch 9 Step 499 Train Loss 0.481   Accuracy 74.438 
Epoch 9 Step 599 Train Loss 0.482   Accuracy 74.349 
INFO:name:  eval_loss = 0.6618
INFO:name:  eval_acc = 0.6581
INFO:name:  f1_score = 0.5793
INFO:name:  recall = 0.5417
INFO:name:  precision = 0.6225
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 10 Step 99 Train Loss 0.47   Accuracy 76.375 
Epoch 10 Step 199 Train Loss 0.473   Accuracy 75.469 
Epoch 10 Step 299 Train Loss 0.474   Accuracy 75.479 
Epoch 10 Step 399 Train Loss 0.473   Accuracy 75.375 
Epoch 10 Step 499 Train Loss 0.471   Accuracy 75.35 
Epoch 10 Step 599 Train Loss 0.474   Accuracy 75.281 
INFO:name:  eval_loss = 0.6607
INFO:name:  eval_acc = 0.664
INFO:name:  f1_score = 0.5637
INFO:name:  recall = 0.4996
INFO:name:  precision = 0.6467
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 11 Step 99 Train Loss 0.473   Accuracy 74.781 
Epoch 11 Step 199 Train Loss 0.461   Accuracy 75.453 
Epoch 11 Step 299 Train Loss 0.465   Accuracy 75.354 
Epoch 11 Step 399 Train Loss 0.464   Accuracy 75.609 
Epoch 11 Step 499 Train Loss 0.463   Accuracy 75.788 
Epoch 11 Step 599 Train Loss 0.463   Accuracy 75.75 
INFO:name:  eval_loss = 0.7108
INFO:name:  eval_acc = 0.6633
INFO:name:  f1_score = 0.5867
INFO:name:  recall = 0.5501
INFO:name:  precision = 0.6285
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 12 Step 99 Train Loss 0.436   Accuracy 78.188 
Epoch 12 Step 199 Train Loss 0.441   Accuracy 77.328 
Epoch 12 Step 299 Train Loss 0.441   Accuracy 76.906 
Epoch 12 Step 399 Train Loss 0.444   Accuracy 76.773 
Epoch 12 Step 499 Train Loss 0.441   Accuracy 76.825 
Epoch 12 Step 599 Train Loss 0.441   Accuracy 77.026 
INFO:name:  eval_loss = 0.7096
INFO:name:  eval_acc = 0.6611
INFO:name:  f1_score = 0.6002
INFO:name:  recall = 0.5855
INFO:name:  precision = 0.6156
INFO:name:Saving model checkpoint to ./models/final_model_defect/model.bin
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6391, 'test_f1_score': 0.5922, 'test_recall': 0.5705, 'test_precision': 0.6156}
train results {'train_loss': [0.683, 0.657, 0.632, 0.596, 0.577, 0.565, 0.546, 0.526, 0.503, 0.484, 0.475, 0.46, 0.442], 'train_acc': [55.242, 59.146, 62.519, 65.283, 66.732, 68.307, 69.64, 70.892, 72.875, 74.078, 75.098, 75.932, 77.024], 'eval_loss': [0.657, 0.652, 0.624, 0.635, 0.624, 0.746, 0.624, 0.635, 0.642, 0.662, 0.661, 0.711, 0.71], 'eval_acc': [0.586, 0.581, 0.626, 0.635, 0.654, 0.605, 0.671, 0.66, 0.652, 0.658, 0.664, 0.663, 0.661], 'eval_f1': [0.388, 0.614, 0.453, 0.591, 0.51, 0.646, 0.558, 0.598, 0.59, 0.579, 0.564, 0.587, 0.6], 'eval_precision': [0.543, 0.512, 0.62, 0.575, 0.662, 0.529, 0.671, 0.614, 0.604, 0.622, 0.647, 0.628, 0.616], 'eval_recall': [0.302, 0.767, 0.356, 0.607, 0.414, 0.828, 0.478, 0.583, 0.575, 0.542, 0.5, 0.55, 0.586]}
