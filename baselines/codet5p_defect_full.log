/home/aakli/miniconda3/envs/adapter/lib/python3.10/site-packages/transformers/utils/generic.py:260: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  torch.utils._pytree._register_pytree_node(
INFO:name:device: cuda:0, n_gpu: 1
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /Salesforce/codet5p-220m/resolve/main/config.json HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /Salesforce/codet5p-220m/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
INFO:name:***** Running training for defect detection *****
INFO:name:  Num examples = 21854
INFO:name:  Num Epochs = 10
INFO:name:  Total train batch size  = 32
INFO:name:  Total optimization steps = 6830
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 0 Step 99 Train Loss 0.689   Accuracy 54.125 
Epoch 0 Step 199 Train Loss 0.689   Accuracy 54.344 
Epoch 0 Step 299 Train Loss 0.688   Accuracy 54.427 
Epoch 0 Step 399 Train Loss 0.688   Accuracy 54.477 
Epoch 0 Step 499 Train Loss 0.689   Accuracy 54.469 
Epoch 0 Step 599 Train Loss 0.689   Accuracy 54.562 
INFO:name:  eval_loss = 0.6812
INFO:name:  eval_acc = 0.5732
INFO:name:  f1_score = 0.295
INFO:name:  recall = 0.2056
INFO:name:  precision = 0.5225
INFO:name:
 ******************************
INFO:name:  Best validation performance :0.5732
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.5666, 'test_f1_score': 0.3265, 'test_recall': 0.2287, 'test_precision': 0.5706}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 1 Step 99 Train Loss 0.687   Accuracy 55.781 
Epoch 1 Step 199 Train Loss 0.684   Accuracy 56.516 
Epoch 1 Step 299 Train Loss 0.68   Accuracy 57.073 
Epoch 1 Step 399 Train Loss 0.676   Accuracy 57.555 
Epoch 1 Step 499 Train Loss 0.674   Accuracy 57.556 
Epoch 1 Step 599 Train Loss 0.672   Accuracy 57.646 
INFO:name:  eval_loss = 0.6405
INFO:name:  eval_acc = 0.6018
INFO:name:  f1_score = 0.5489
INFO:name:  recall = 0.5577
INFO:name:  precision = 0.5404
INFO:name:
 ******************************
INFO:name:  Best validation performance :0.6018
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.5944, 'test_f1_score': 0.5554, 'test_recall': 0.5514, 'test_precision': 0.5594}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 2 Step 99 Train Loss 0.638   Accuracy 62.125 
Epoch 2 Step 199 Train Loss 0.628   Accuracy 63.594 
Epoch 2 Step 299 Train Loss 0.626   Accuracy 63.49 
Epoch 2 Step 399 Train Loss 0.626   Accuracy 63.539 
Epoch 2 Step 499 Train Loss 0.623   Accuracy 63.775 
Epoch 2 Step 599 Train Loss 0.62   Accuracy 64.146 
INFO:name:  eval_loss = 0.611
INFO:name:  eval_acc = 0.6325
INFO:name:  f1_score = 0.6106
INFO:name:  recall = 0.663
INFO:name:  precision = 0.5658
INFO:name:
 ******************************
INFO:name:  Best validation performance :0.6325
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6212, 'test_f1_score': 0.6116, 'test_recall': 0.6494, 'test_precision': 0.578}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 3 Step 99 Train Loss 0.551   Accuracy 69.656 
Epoch 3 Step 199 Train Loss 0.548   Accuracy 70.141 
Epoch 3 Step 299 Train Loss 0.552   Accuracy 69.99 
Epoch 3 Step 399 Train Loss 0.552   Accuracy 70.117 
Epoch 3 Step 499 Train Loss 0.553   Accuracy 70.019 
Epoch 3 Step 599 Train Loss 0.551   Accuracy 70.286 
INFO:name:  eval_loss = 0.6489
INFO:name:  eval_acc = 0.6486
INFO:name:  f1_score = 0.6007
INFO:name:  recall = 0.6083
INFO:name:  precision = 0.5933
INFO:name:
 ******************************
INFO:name:  Best validation performance :0.6486
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6245, 'test_f1_score': 0.5912, 'test_recall': 0.5912, 'test_precision': 0.5912}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 4 Step 99 Train Loss 0.469   Accuracy 76.0 
Epoch 4 Step 199 Train Loss 0.469   Accuracy 75.984 
Epoch 4 Step 299 Train Loss 0.468   Accuracy 76.302 
Epoch 4 Step 399 Train Loss 0.474   Accuracy 75.703 
Epoch 4 Step 499 Train Loss 0.472   Accuracy 75.825 
Epoch 4 Step 599 Train Loss 0.475   Accuracy 75.698 
INFO:name:  eval_loss = 0.6377
INFO:name:  eval_acc = 0.6409
INFO:name:  f1_score = 0.6172
INFO:name:  recall = 0.6664
INFO:name:  precision = 0.5749
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 5 Step 99 Train Loss 0.396   Accuracy 81.0 
Epoch 5 Step 199 Train Loss 0.394   Accuracy 80.75 
Epoch 5 Step 299 Train Loss 0.397   Accuracy 80.792 
Epoch 5 Step 399 Train Loss 0.401   Accuracy 80.539 
Epoch 5 Step 499 Train Loss 0.401   Accuracy 80.406 
Epoch 5 Step 599 Train Loss 0.402   Accuracy 80.281 
INFO:name:  eval_loss = 0.771
INFO:name:  eval_acc = 0.6508
INFO:name:  f1_score = 0.5902
INFO:name:  recall = 0.5788
INFO:name:  precision = 0.6021
INFO:name:
 ******************************
INFO:name:  Best validation performance :0.6508
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6347, 'test_f1_score': 0.5886, 'test_recall': 0.5689, 'test_precision': 0.6097}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 6 Step 99 Train Loss 0.323   Accuracy 84.781 
Epoch 6 Step 199 Train Loss 0.332   Accuracy 84.391 
Epoch 6 Step 299 Train Loss 0.336   Accuracy 83.969 
Epoch 6 Step 399 Train Loss 0.336   Accuracy 83.922 
Epoch 6 Step 499 Train Loss 0.338   Accuracy 83.831 
Epoch 6 Step 599 Train Loss 0.339   Accuracy 83.885 
INFO:name:  eval_loss = 0.8385
INFO:name:  eval_acc = 0.6369
INFO:name:  f1_score = 0.5782
INFO:name:  recall = 0.5729
INFO:name:  precision = 0.5837
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 7 Step 99 Train Loss 0.277   Accuracy 87.906 
Epoch 7 Step 199 Train Loss 0.268   Accuracy 87.844 
Epoch 7 Step 299 Train Loss 0.275   Accuracy 87.74 
Epoch 7 Step 399 Train Loss 0.28   Accuracy 87.273 
Epoch 7 Step 499 Train Loss 0.285   Accuracy 86.975 
Epoch 7 Step 599 Train Loss 0.287   Accuracy 86.823 
INFO:name:  eval_loss = 1.0115
INFO:name:  eval_acc = 0.6354
INFO:name:  f1_score = 0.5651
INFO:name:  recall = 0.5451
INFO:name:  precision = 0.5866
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 8 Step 99 Train Loss 0.224   Accuracy 89.844 
Epoch 8 Step 199 Train Loss 0.237   Accuracy 89.125 
Epoch 8 Step 299 Train Loss 0.241   Accuracy 88.76 
Epoch 8 Step 399 Train Loss 0.244   Accuracy 88.617 
Epoch 8 Step 499 Train Loss 0.243   Accuracy 88.7 
Epoch 8 Step 599 Train Loss 0.244   Accuracy 88.682 
INFO:name:  eval_loss = 1.2003
INFO:name:  eval_acc = 0.6274
INFO:name:  f1_score = 0.5835
INFO:name:  recall = 0.6007
INFO:name:  precision = 0.5672
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 9 Step 99 Train Loss 0.205   Accuracy 90.969 
Epoch 9 Step 199 Train Loss 0.208   Accuracy 91.016 
Epoch 9 Step 299 Train Loss 0.211   Accuracy 90.771 
Epoch 9 Step 399 Train Loss 0.208   Accuracy 90.828 
Epoch 9 Step 499 Train Loss 0.206   Accuracy 90.781 
Epoch 9 Step 599 Train Loss 0.204   Accuracy 90.88 
INFO:name:  eval_loss = 1.3005
INFO:name:  eval_acc = 0.6274
INFO:name:  f1_score = 0.5737
INFO:name:  recall = 0.5771
INFO:name:  precision = 0.5704
INFO:name:Saving model checkpoint to ./models/final_model_defect/model.bin
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6072, 'test_f1_score': 0.5706, 'test_recall': 0.5681, 'test_precision': 0.5732}
train results {'train_loss': [0.688, 0.67, 0.618, 0.551, 0.476, 0.404, 0.34, 0.289, 0.242, 0.205], 'train_acc': [54.894, 57.917, 64.176, 70.253, 75.555, 80.159, 83.733, 86.593, 88.707, 90.798], 'eval_loss': [0.681, 0.64, 0.611, 0.649, 0.638, 0.771, 0.839, 1.012, 1.2, 1.3], 'eval_acc': [0.573, 0.602, 0.632, 0.649, 0.641, 0.651, 0.637, 0.635, 0.627, 0.627], 'eval_f1': [0.295, 0.549, 0.611, 0.601, 0.617, 0.59, 0.578, 0.565, 0.584, 0.574], 'eval_precision': [0.522, 0.54, 0.566, 0.593, 0.575, 0.602, 0.584, 0.587, 0.567, 0.57], 'eval_recall': [0.206, 0.558, 0.663, 0.608, 0.666, 0.579, 0.573, 0.545, 0.601, 0.577]}
