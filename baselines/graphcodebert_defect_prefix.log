/home/aakli/miniconda3/envs/adapter/lib/python3.10/site-packages/transformers/utils/generic.py:260: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  torch.utils._pytree._register_pytree_node(
INFO:name:device: cuda:1, n_gpu: 1
DEBUG:urllib3.connectionpool:Starting new HTTPS connection (1): huggingface.co:443
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /microsoft/graphcodebert-base/resolve/main/config.json HTTP/1.1" 200 0
DEBUG:urllib3.connectionpool:https://huggingface.co:443 "HEAD /microsoft/graphcodebert-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
root
├── embeddings (RobertaEmbeddings)
│   ├── word_embeddings (Embedding) weight:[50265, 768]
│   ├── position_embeddings (Embedding) weight:[514, 768]
│   ├── token_type_embeddings (Embedding) weight:[1, 768]
│   └── LayerNorm (LayerNorm) weight:[768] bias:[768]
├── encoder (RobertaEncoder)
│   └── layer (ModuleList)
│       ├── 0 (RobertaLayer)
│       │   ├── attention (RobertaAttention)
│       │   │   ├── self (RobertaSelfAttention)
│       │   │   │   └── query,key,value(Linear) weight:[768, 768] bias:[768]
│       │   │   ├── output (RobertaSelfOutput)
│       │   │   │   ├── dense (Linear) weight:[768, 768] bias:[768]
│       │   │   │   └── LayerNorm (LayerNorm) weight:[768] bias:[768]
│       │   │   └── reparams (ReparameterizeFunction) input_tokens:[6]
│       │   │       ├── module_list (ModuleList)
│       │   │       ├── wte (Embedding) weight:[6, 512]
│       │   │       └── control_trans (Sequential)
│       │   │           ├── 0 (Linear) weight:[512, 512] bias:[512]
│       │   │           └── 2 (Linear) weight:[18432, 512] bias:[18432]
│       │   ├── intermediate (RobertaIntermediate)
│       │   │   └── dense (Linear) weight:[3072, 768] bias:[3072]
│       │   └── output (RobertaOutput)
│       │       ├── dense (Linear) weight:[768, 3072] bias:[768]
│       │       └── LayerNorm (LayerNorm) weight:[768] bias:[768]
│       └── 1-11(RobertaLayer)
│           ├── attention (RobertaAttention)
│           │   ├── self (RobertaSelfAttention)
│           │   │   └── query,key,value(Linear) weight:[768, 768] bias:[768]
│           │   └── output (RobertaSelfOutput)
│           │       ├── dense (Linear) weight:[768, 768] bias:[768]
│           │       └── LayerNorm (LayerNorm) weight:[768] bias:[768]
│           ├── intermediate (RobertaIntermediate)
│           │   └── dense (Linear) weight:[3072, 768] bias:[3072]
│           └── output (RobertaOutput)
│               ├── dense (Linear) weight:[768, 3072] bias:[768]
│               └── LayerNorm (LayerNorm) weight:[768] bias:[768]
└── pooler (RobertaPooler)
    └── dense (Linear) weight:[768, 768] bias:[768]
[INFO|(OpenDelta)basemodel:700]2025-01-17 00:49:46,704 >> Trainable Ratio: 9721344/134366982=7.234920%
[INFO|(OpenDelta)basemodel:702]2025-01-17 00:49:46,704 >> Delta Parameter Ratio: 9721350/134366982=7.234925%
[INFO|(OpenDelta)basemodel:704]2025-01-17 00:49:46,704 >> Static Memory 0.00 GB, Max Memory 0.00 GB
INFO:name:***** Running training for defect detection *****
INFO:name:  Num examples = 21854
INFO:name:  Num Epochs = 15
INFO:name:  Total train batch size  = 32
INFO:name:  Total optimization steps = 10245
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 0 Step 99 Train Loss 0.692   Accuracy 52.719 
Epoch 0 Step 199 Train Loss 0.691   Accuracy 52.906 
Epoch 0 Step 299 Train Loss 0.691   Accuracy 53.125 
Epoch 0 Step 399 Train Loss 0.69   Accuracy 53.461 
Epoch 0 Step 499 Train Loss 0.689   Accuracy 53.788 
Epoch 0 Step 599 Train Loss 0.687   Accuracy 54.229 
INFO:name:  eval_loss = 0.6764
INFO:name:  eval_acc = 0.5754
INFO:name:  f1_score = 0.1433
INFO:name:  recall = 0.0817
INFO:name:  precision = 0.5808
INFO:name:
 ******************************
INFO:name:  Best validation performance :0.5754
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.5575, 'test_f1_score': 0.1383, 'test_recall': 0.0773, 'test_precision': 0.6554}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 1 Step 99 Train Loss 0.676   Accuracy 57.375 
Epoch 1 Step 199 Train Loss 0.675   Accuracy 57.234 
Epoch 1 Step 299 Train Loss 0.671   Accuracy 58.177 
Epoch 1 Step 399 Train Loss 0.67   Accuracy 58.258 
Epoch 1 Step 499 Train Loss 0.67   Accuracy 58.25 
Epoch 1 Step 599 Train Loss 0.669   Accuracy 58.161 
INFO:name:  eval_loss = 0.6494
INFO:name:  eval_acc = 0.5999
INFO:name:  f1_score = 0.2708
INFO:name:  recall = 0.171
INFO:name:  precision = 0.6506
INFO:name:
 ******************************
INFO:name:  Best validation performance :0.5999
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.578, 'test_f1_score': 0.2566, 'test_recall': 0.1586, 'test_precision': 0.6723}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 2 Step 99 Train Loss 0.647   Accuracy 60.938 
Epoch 2 Step 199 Train Loss 0.654   Accuracy 59.781 
Epoch 2 Step 299 Train Loss 0.656   Accuracy 59.271 
Epoch 2 Step 399 Train Loss 0.656   Accuracy 59.273 
Epoch 2 Step 499 Train Loss 0.654   Accuracy 59.55 
Epoch 2 Step 599 Train Loss 0.655   Accuracy 59.245 
INFO:name:  eval_loss = 0.6555
INFO:name:  eval_acc = 0.6051
INFO:name:  f1_score = 0.2655
INFO:name:  recall = 0.1643
INFO:name:  precision = 0.6915
INFO:name:
 ******************************
INFO:name:  Best validation performance :0.6051
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.5838, 'test_f1_score': 0.2515, 'test_recall': 0.1522, 'test_precision': 0.7235}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 3 Step 99 Train Loss 0.635   Accuracy 62.25 
Epoch 3 Step 199 Train Loss 0.635   Accuracy 61.625 
Epoch 3 Step 299 Train Loss 0.637   Accuracy 61.5 
Epoch 3 Step 399 Train Loss 0.638   Accuracy 61.672 
Epoch 3 Step 499 Train Loss 0.638   Accuracy 61.45 
Epoch 3 Step 599 Train Loss 0.639   Accuracy 61.297 
INFO:name:  eval_loss = 0.6412
INFO:name:  eval_acc = 0.6018
INFO:name:  f1_score = 0.4982
INFO:name:  recall = 0.4549
INFO:name:  precision = 0.5505
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 4 Step 99 Train Loss 0.63   Accuracy 62.531 
Epoch 4 Step 199 Train Loss 0.631   Accuracy 62.641 
Epoch 4 Step 299 Train Loss 0.63   Accuracy 62.385 
Epoch 4 Step 399 Train Loss 0.631   Accuracy 61.922 
Epoch 4 Step 499 Train Loss 0.629   Accuracy 62.131 
Epoch 4 Step 599 Train Loss 0.63   Accuracy 62.078 
INFO:name:  eval_loss = 0.6301
INFO:name:  eval_acc = 0.6083
INFO:name:  f1_score = 0.5167
INFO:name:  recall = 0.4819
INFO:name:  precision = 0.557
INFO:name:
 ******************************
INFO:name:  Best validation performance :0.6083
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6076, 'test_f1_score': 0.5265, 'test_recall': 0.4749, 'test_precision': 0.5907}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 5 Step 99 Train Loss 0.62   Accuracy 63.625 
Epoch 5 Step 199 Train Loss 0.623   Accuracy 62.75 
Epoch 5 Step 299 Train Loss 0.62   Accuracy 63.021 
Epoch 5 Step 399 Train Loss 0.62   Accuracy 63.148 
Epoch 5 Step 499 Train Loss 0.62   Accuracy 62.994 
Epoch 5 Step 599 Train Loss 0.62   Accuracy 63.245 
INFO:name:  eval_loss = 0.6255
INFO:name:  eval_acc = 0.6131
INFO:name:  f1_score = 0.5211
INFO:name:  recall = 0.4844
INFO:name:  precision = 0.5637
INFO:name:
 ******************************
INFO:name:  Best validation performance :0.6131
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6201, 'test_f1_score': 0.5374, 'test_recall': 0.4805, 'test_precision': 0.6097}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 6 Step 99 Train Loss 0.615   Accuracy 63.75 
Epoch 6 Step 199 Train Loss 0.616   Accuracy 63.312 
Epoch 6 Step 299 Train Loss 0.609   Accuracy 64.01 
Epoch 6 Step 399 Train Loss 0.611   Accuracy 63.852 
Epoch 6 Step 499 Train Loss 0.609   Accuracy 64.006 
Epoch 6 Step 599 Train Loss 0.61   Accuracy 63.943 
INFO:name:  eval_loss = 0.6198
INFO:name:  eval_acc = 0.6274
INFO:name:  f1_score = 0.5005
INFO:name:  recall = 0.4297
INFO:name:  precision = 0.5993
INFO:name:
 ******************************
INFO:name:  Best validation performance :0.6274
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6153, 'test_f1_score': 0.5049, 'test_recall': 0.4271, 'test_precision': 0.6175}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 7 Step 99 Train Loss 0.6   Accuracy 65.406 
Epoch 7 Step 199 Train Loss 0.601   Accuracy 65.656 
Epoch 7 Step 299 Train Loss 0.601   Accuracy 65.583 
Epoch 7 Step 399 Train Loss 0.6   Accuracy 65.969 
Epoch 7 Step 499 Train Loss 0.602   Accuracy 65.394 
Epoch 7 Step 599 Train Loss 0.602   Accuracy 65.198 
INFO:name:  eval_loss = 0.6213
INFO:name:  eval_acc = 0.6387
INFO:name:  f1_score = 0.5013
INFO:name:  recall = 0.4179
INFO:name:  precision = 0.6263
INFO:name:
 ******************************
INFO:name:  Best validation performance :0.6387
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6226, 'test_f1_score': 0.4949, 'test_recall': 0.4024, 'test_precision': 0.6425}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 8 Step 99 Train Loss 0.594   Accuracy 65.125 
Epoch 8 Step 199 Train Loss 0.595   Accuracy 65.047 
Epoch 8 Step 299 Train Loss 0.596   Accuracy 64.771 
Epoch 8 Step 399 Train Loss 0.595   Accuracy 65.25 
Epoch 8 Step 499 Train Loss 0.594   Accuracy 65.506 
Epoch 8 Step 599 Train Loss 0.592   Accuracy 65.635 
INFO:name:  eval_loss = 0.6171
INFO:name:  eval_acc = 0.6362
INFO:name:  f1_score = 0.5108
INFO:name:  recall = 0.4372
INFO:name:  precision = 0.6142
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 9 Step 99 Train Loss 0.583   Accuracy 66.969 
Epoch 9 Step 199 Train Loss 0.584   Accuracy 66.375 
Epoch 9 Step 299 Train Loss 0.584   Accuracy 66.25 
Epoch 9 Step 399 Train Loss 0.581   Accuracy 66.727 
Epoch 9 Step 499 Train Loss 0.581   Accuracy 66.712 
Epoch 9 Step 599 Train Loss 0.583   Accuracy 66.568 
INFO:name:  eval_loss = 0.612
INFO:name:  eval_acc = 0.6255
INFO:name:  f1_score = 0.56
INFO:name:  recall = 0.5484
INFO:name:  precision = 0.5721
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 10 Step 99 Train Loss 0.578   Accuracy 67.469 
Epoch 10 Step 199 Train Loss 0.573   Accuracy 68.031 
Epoch 10 Step 299 Train Loss 0.575   Accuracy 68.052 
Epoch 10 Step 399 Train Loss 0.574   Accuracy 67.828 
Epoch 10 Step 499 Train Loss 0.573   Accuracy 68.069 
Epoch 10 Step 599 Train Loss 0.573   Accuracy 68.042 
INFO:name:  eval_loss = 0.6165
INFO:name:  eval_acc = 0.6285
INFO:name:  f1_score = 0.5519
INFO:name:  recall = 0.5265
INFO:name:  precision = 0.5798
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 11 Step 99 Train Loss 0.568   Accuracy 68.75 
Epoch 11 Step 199 Train Loss 0.565   Accuracy 68.969 
Epoch 11 Step 299 Train Loss 0.564   Accuracy 68.698 
Epoch 11 Step 399 Train Loss 0.568   Accuracy 68.234 
Epoch 11 Step 499 Train Loss 0.568   Accuracy 68.225 
Epoch 11 Step 599 Train Loss 0.568   Accuracy 68.052 
INFO:name:  eval_loss = 0.6231
INFO:name:  eval_acc = 0.6252
INFO:name:  f1_score = 0.5723
INFO:name:  recall = 0.5771
INFO:name:  precision = 0.5675
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 12 Step 99 Train Loss 0.568   Accuracy 67.562 
Epoch 12 Step 199 Train Loss 0.565   Accuracy 67.719 
Epoch 12 Step 299 Train Loss 0.561   Accuracy 68.104 
Epoch 12 Step 399 Train Loss 0.562   Accuracy 68.273 
Epoch 12 Step 499 Train Loss 0.563   Accuracy 68.312 
Epoch 12 Step 599 Train Loss 0.561   Accuracy 68.349 
INFO:name:  eval_loss = 0.6188
INFO:name:  eval_acc = 0.6336
INFO:name:  f1_score = 0.5525
INFO:name:  recall = 0.5206
INFO:name:  precision = 0.5886
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 13 Step 99 Train Loss 0.557   Accuracy 68.125 
Epoch 13 Step 199 Train Loss 0.555   Accuracy 68.828 
Epoch 13 Step 299 Train Loss 0.547   Accuracy 69.385 
Epoch 13 Step 399 Train Loss 0.551   Accuracy 69.141 
Epoch 13 Step 499 Train Loss 0.553   Accuracy 68.95 
Epoch 13 Step 599 Train Loss 0.555   Accuracy 69.052 
INFO:name:  eval_loss = 0.621
INFO:name:  eval_acc = 0.6417
INFO:name:  f1_score = 0.5486
INFO:name:  recall = 0.5013
INFO:name:  precision = 0.6059
INFO:name:
 ******************************
INFO:name:  Best validation performance :0.6417
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6329, 'test_f1_score': 0.5564, 'test_recall': 0.5012, 'test_precision': 0.6252}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:
***** Running evaluation *****
INFO:name:  Num examples vulnerability detection = 2732
INFO:name:  Batch size = 32 
Epoch 14 Step 99 Train Loss 0.545   Accuracy 69.844 
Epoch 14 Step 199 Train Loss 0.551   Accuracy 69.016 
Epoch 14 Step 299 Train Loss 0.553   Accuracy 68.958 
Epoch 14 Step 399 Train Loss 0.553   Accuracy 69.016 
Epoch 14 Step 499 Train Loss 0.553   Accuracy 68.938 
Epoch 14 Step 599 Train Loss 0.552   Accuracy 69.005 
INFO:name:  eval_loss = 0.6235
INFO:name:  eval_acc = 0.6424
INFO:name:  f1_score = 0.5541
INFO:name:  recall = 0.5114
INFO:name:  precision = 0.6046
INFO:name:
 ******************************
INFO:name:  Best validation performance :0.6424
INFO:name:  ******************************
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6303, 'test_f1_score': 0.5578, 'test_recall': 0.5076, 'test_precision': 0.619}
INFO:name:Saving model checkpoint to ./models/best_model_defect/model.bin
INFO:name:Saving model checkpoint to ./models/final_model_defect/model.bin
INFO:name:***** Test Results for task defect detection 
INFO:name:{'test_acc': 0.6303, 'test_f1_score': 0.5578, 'test_recall': 0.5076, 'test_precision': 0.619}
train results {'train_loss': [0.687, 0.668, 0.654, 0.64, 0.628, 0.619, 0.609, 0.602, 0.592, 0.584, 0.574, 0.568, 0.561, 0.555, 0.553], 'train_acc': [54.31, 58.036, 59.408, 61.17, 62.254, 63.193, 63.878, 65.197, 65.769, 66.472, 67.86, 68.015, 68.409, 68.961, 69.077], 'eval_loss': [0.676, 0.649, 0.655, 0.641, 0.63, 0.625, 0.62, 0.621, 0.617, 0.612, 0.617, 0.623, 0.619, 0.621, 0.624], 'eval_acc': [0.575, 0.6, 0.605, 0.602, 0.608, 0.613, 0.627, 0.639, 0.636, 0.626, 0.628, 0.625, 0.634, 0.642, 0.642], 'eval_f1': [0.143, 0.271, 0.266, 0.498, 0.517, 0.521, 0.5, 0.501, 0.511, 0.56, 0.552, 0.572, 0.552, 0.549, 0.554], 'eval_precision': [0.581, 0.651, 0.692, 0.55, 0.557, 0.564, 0.599, 0.626, 0.614, 0.572, 0.58, 0.568, 0.589, 0.606, 0.605], 'eval_recall': [0.082, 0.171, 0.164, 0.455, 0.482, 0.484, 0.43, 0.418, 0.437, 0.548, 0.526, 0.577, 0.521, 0.501, 0.511]}
